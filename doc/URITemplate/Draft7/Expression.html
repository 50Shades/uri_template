<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: URITemplate::Draft7::Expression
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../URITemplate.html" title="URITemplate (module)">URITemplate</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Draft7.html" title="URITemplate::Draft7 (class)">Draft7</a></span></span>
     &raquo; 
    <span class="title">Expression</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: URITemplate::Draft7::Expression
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../RFC6570/Expression.html" title="URITemplate::RFC6570::Expression (class)">RFC6570::Expression</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../RFC6570/Token.html" title="URITemplate::RFC6570::Token (class)">RFC6570::Token</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../RFC6570/Expression.html" title="URITemplate::RFC6570::Expression (class)">RFC6570::Expression</a></span></li>
          
            <li class="next">URITemplate::Draft7::Expression</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
      <dt class="r2">Extended by:</dt>
      <dd class="r2"><span class='object_link'><a href="Expression/ClassMethods.html" title="URITemplate::Draft7::Expression::ClassMethods (module)">ClassMethods</a></span></dd>
      
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/uri_template/draft7.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  






  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Expression.html" title="URITemplate::Expression (module)">Expression</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Expression.html#variables-instance_method" title="URITemplate::Expression#variables (method)">#variables</a></span></p>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract-instance_method" title="#extract (instance method)">- (Object) <strong>extract</strong>(position, matched) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_r_source-instance_method" title="#to_r_source (instance method)">- (Object) <strong>to_r_source</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Expression/ClassMethods.html" title="URITemplate::Draft7::Expression::ClassMethods (module)">ClassMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Expression/ClassMethods.html#hash_extractor-instance_method" title="URITemplate::Draft7::Expression::ClassMethods#hash_extractor (method)">hash_extractor</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../RFC6570/Expression/ClassMethods.html" title="URITemplate::RFC6570::Expression::ClassMethods (module)">RFC6570::Expression::ClassMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../RFC6570/Expression/ClassMethods.html#hash_extractor-instance_method" title="URITemplate::RFC6570::Expression::ClassMethods#hash_extractor (method)">#hash_extractor</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Expression.html" title="URITemplate::Expression (module)">Expression</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Expression.html#expression%3F-instance_method" title="URITemplate::Expression#expression? (method)">#expression?</a></span>, <span class='object_link'><a href="../Expression.html#literal%3F-instance_method" title="URITemplate::Expression#literal? (method)">#literal?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Token.html" title="URITemplate::Token (module)">Token</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Token.html#size-instance_method" title="URITemplate::Token#size (method)">#size</a></span></p>

  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="extract-instance_method">
  
    - (<tt>Object</tt>) <strong>extract</strong>(position, matched) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/uri_template/draft7.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract'>extract</span><span class='lparen'>(</span><span class='id identifier rubyid_position'>position</span><span class='comma'>,</span><span class='id identifier rubyid_matched'>matched</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_expand'>expand</span><span class='comma'>,</span> <span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>=</span> <span class='ivar'>@variable_specs</span><span class='lbracket'>[</span><span class='id identifier rubyid_position'>position</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_matched'>matched</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span> <span class='comma'>,</span> <span class='id identifier rubyid_matched'>matched</span> <span class='rbracket'>]</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_expand'>expand</span>
    <span class='comment'>#TODO: do we really need this? - this could be stolen from rack
</span>    <span class='id identifier rubyid_ex'>ex</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_hash_extractor'>hash_extractor</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_matched'>matched</span>
    <span class='id identifier rubyid_splitted'>splitted</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_found_value'>found_value</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='comment'># 1 = name
</span>    <span class='comment'># 2 = value
</span>    <span class='comment'># 3 = rest
</span>    <span class='kw'>until</span> <span class='id identifier rubyid_rest'>rest</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
      <span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='id identifier rubyid_ex'>ex</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_rest'>rest</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_match'>match</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn't match </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rest'>rest</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'> againts the hash extractor. This is definitly a Bug. Please report this ASAP!</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_match'>match</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_found_value'>found_value</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_splitted'>splitted</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_rest'>rest</span> <span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_splitted'>splitted</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_rest'>rest</span><span class='comma'>,</span> <span class='kw'>nil</span> <span class='rbracket'>]</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_rest'>rest</span> <span class='op'>=</span> <span class='id identifier rubyid_match'>match</span><span class='period'>.</span><span class='id identifier rubyid_post_match'>post_match</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_found_value'>found_value</span>
      <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_splitted'>splitted</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span> <span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_splitted'>splitted</span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>NAMED</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span> <span class='id identifier rubyid_matched'>matched</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>  <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span> <span class='id identifier rubyid_matched'>matched</span> <span class='rparen'>)</span> <span class='rbracket'>]</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_r_source-instance_method">
  
    - (<tt>Object</tt>) <strong>to_r_source</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/uri_template/draft7.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_r_source'>to_r_source</span>
  <span class='id identifier rubyid_source'>source</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_first'>first</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_vs'>vs</span> <span class='op'>=</span> <span class='ivar'>@variable_specs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span>
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>NAMED</span>
    <span class='ivar'>@variable_specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_expand'>expand</span> <span class='comma'>,</span> <span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>|,)</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='op'>?</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{0,</span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_max_length'>max_length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>}</span><span class='tstring_end'>'</span></span><span class='op'>:</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_expand'>expand</span>
        <span class='comment'>#if self.class::PAIR_IF_EMPTY
</span>        <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='const'>CHARACTER_CLASSES</span><span class='lbracket'>[</span><span class='symbol'>:varname</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PAIR_CONNECTOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>)?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>

        <span class='kw'>if</span> <span class='id identifier rubyid_first'>first</span>
          <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>((?:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)(?:</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)*)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>((?:</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)*)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PAIR_IF_EMPTY</span>
          <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PAIR_CONNECTOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PAIR_CONNECTOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>|)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)?</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_first'>first</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span>
    <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='ivar'>@variable_specs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span> <span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_expand'>expand</span> <span class='comma'>,</span> <span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>|</span>
      <span class='id identifier rubyid_last'>last</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_vs'>vs</span> <span class='op'>==</span> <span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_expand'>expand</span>
        <span class='comment'># could be list or map, too
</span>        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='op'>?</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{0,</span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_max_length'>max_length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>}</span><span class='tstring_end'>'</span></span><span class='op'>:</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>

        <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='const'>CHARACTER_CLASSES</span><span class='lbracket'>[</span><span class='symbol'>:varname</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PAIR_CONNECTOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>)?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>

        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_pair'>pair</span><span class='rbrace'>}</span><span class='tstring_content'>)*</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_last'>last</span>
        <span class='comment'># the last will slurp lists
</span>        <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:grabs_comma</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='op'>?</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{0,</span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_max_length'>max_length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>}</span><span class='tstring_end'>'</span></span><span class='op'>:</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*?</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>|,)</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='op'>?</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{0,</span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_max_length'>max_length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>}</span><span class='tstring_end'>'</span></span><span class='op'>:</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*?</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>CHARACTER_CLASS</span><span class='lbracket'>[</span><span class='symbol'>:class</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_max_length'>max_length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span><span class='op'>?</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>{0,</span><span class='tstring_end'>'</span></span><span class='op'>+</span><span class='id identifier rubyid_max_length'>max_length</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='op'>+</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>}</span><span class='tstring_end'>'</span></span><span class='op'>:</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*?</span><span class='tstring_end'>'</span></span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_first'>first</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(?:</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>SEPARATOR</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>))?</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(?:</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='op'>::</span><span class='const'>PREFIX</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>)?</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Jul  3 19:56:07 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.9.3).
</div>

  </body>
</html>