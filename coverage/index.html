<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Uri template7</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.5.3/jquery-1.6.2.min.js' type='text/javascript'></script>
    <script src='./assets/0.5.3/jquery.dataTables.min.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/fancybox/jquery.fancybox-1.3.1.pack.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/jquery.timeago.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/jquery.url.js' type='text/javascript'></script>   
    <script src='./assets/0.5.3/highlight.pack.js' type='text/javascript'></script>  
    <script src='./assets/0.5.3/app.js' type='text/javascript'></script>    
    <link href='./assets/0.5.3/stylesheet.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/highlight.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/fancybox/jquery.fancybox-1.3.1.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.5.3/smoothness/jquery-ui-1.8.4.custom.css' media='screen, projection, print' rel='stylesheet' type='text/css'>    
    <link rel="shortcut icon" type="image/png" href="./assets/0.5.3/favicon_green.png" />
    <link rel="icon" type="image/png" href="./assets/0.5.3/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.5.3/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2012-09-23T19:36:15+02:00">2012-09-23T19:36:15+02:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="green">95.61%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         112.77
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>11</b> files in total.
    <b>866</b> relevant lines. 
    <span class="green"><b>828</b> lines covered</span> and
    <span class="red"><b>38</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#d4275a0f3994093bbcd2c3b31275f5d09a924c13" class="src_link" title="lib/uri_template.rb">lib/uri_template.rb</a></td>
        <td class="green strong">97.74 %</td>
        <td>406</td>
        <td>133</td>
        <td>130</td>
        <td>3</td>
        <td>35.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9fa8ad920a79b98903cb57c06430e4f7a4b80337" class="src_link" title="lib/uri_template/colon.rb">lib/uri_template/colon.rb</a></td>
        <td class="green strong">97.83 %</td>
        <td>213</td>
        <td>92</td>
        <td>90</td>
        <td>2</td>
        <td>8.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e4fdda42d3ce208ff79e2b3bdac126cf303e9a14" class="src_link" title="lib/uri_template/expression.rb">lib/uri_template/expression.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>33</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>63.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5b9692d9a3b0142a10ad55a44c886cc746f796eb" class="src_link" title="lib/uri_template/literal.rb">lib/uri_template/literal.rb</a></td>
        <td class="green strong">94.12 %</td>
        <td>53</td>
        <td>17</td>
        <td>16</td>
        <td>1</td>
        <td>15.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2fab4ed61bea47f8f91639421b60422e1e1dc724" class="src_link" title="lib/uri_template/rfc6570.rb">lib/uri_template/rfc6570.rb</a></td>
        <td class="green strong">93.55 %</td>
        <td>474</td>
        <td>155</td>
        <td>145</td>
        <td>10</td>
        <td>134.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4a47c80e51df05715b69056531364f778bce472e" class="src_link" title="lib/uri_template/rfc6570/expression.rb">lib/uri_template/rfc6570/expression.rb</a></td>
        <td class="green strong">98.98 %</td>
        <td>374</td>
        <td>196</td>
        <td>194</td>
        <td>2</td>
        <td>141.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b97e0fe3146c9fb0fd6aeb28917b10cb0be28791" class="src_link" title="lib/uri_template/rfc6570/expression/named.rb">lib/uri_template/rfc6570/expression/named.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>72</td>
        <td>31</td>
        <td>31</td>
        <td>0</td>
        <td>66.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d1a53ea0b314d5300e342176347ca474bcb4686d" class="src_link" title="lib/uri_template/rfc6570/expression/unnamed.rb">lib/uri_template/rfc6570/expression/unnamed.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>76</td>
        <td>35</td>
        <td>35</td>
        <td>0</td>
        <td>99.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e8e766627c1416175838d0d9b6e8a4e6eb2ac836" class="src_link" title="lib/uri_template/rfc6570/regex_builder.rb">lib/uri_template/rfc6570/regex_builder.rb</a></td>
        <td class="green strong">92.98 %</td>
        <td>117</td>
        <td>57</td>
        <td>53</td>
        <td>4</td>
        <td>334.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2cacadfea260c7a295cc371f99994f16154ec4df" class="src_link" title="lib/uri_template/token.rb">lib/uri_template/token.rb</a></td>
        <td class="yellow strong">88.89 %</td>
        <td>64</td>
        <td>18</td>
        <td>16</td>
        <td>2</td>
        <td>2.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f8d256d1ef3e0fd588dc69c54499afd0f2cfe206" class="src_link" title="lib/uri_template/utils.rb">lib/uri_template/utils.rb</a></td>
        <td class="yellow strong">88.8 %</td>
        <td>333</td>
        <td>125</td>
        <td>111</td>
        <td>14</td>
        <td>337.3</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.6.4 
        and simplecov-html v0.5.3<br/>
        using RSpec
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="d4275a0f3994093bbcd2c3b31275f5d09a924c13">
  <div class="header">
    <h3>lib/uri_template.rb</h3>
    <h4><span class="green">97.74 %</span> covered</h4>
    <div>
      <b>133</b> relevant lines. 
      <span class="green"><b>130</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># A base module for all implementations of a uri template.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  SCHEME_REGEX = /\A[a-z]+:/i.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  HOST_REGEX = /\A(?:[a-z]+:)?\/\/[^\/]+/i.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  URI_SPLIT = /\A(?:([a-z]+):)?(?:\/\/)?([^\/]+)?/i.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Utils, 'uri_template/utils'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Token, 'uri_template/token'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Literal, 'uri_template/literal'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Expression, 'uri_template/expression'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :RFC6570, 'uri_template/rfc6570'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Colon, 'uri_template/colon'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  # A hash with all available implementations.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  # @see resolve_class</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  VERSIONS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    :rfc6570 =&gt; :RFC6570,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    :default =&gt; :RFC6570,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    :colon =&gt; :Colon,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    :latest =&gt; :RFC6570</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  # Looks up which implementation to use.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  # Extracts all symbols from args and looks up the first in {VERSIONS}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  # @return Array an array of the class to use and the unused parameters.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  #   URITemplate.resolve_class() #=&gt; [ URITemplate::RFC6570, [] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  #   URITemplate.resolve_class(:colon) #=&gt; [ URITemplate::Colon, [] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  #   URITemplate.resolve_class(&quot;template&quot;,:rfc6570) #=&gt; [ URITemplate::RFC6570, [&quot;template&quot;] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  # @raise ArgumentError when no class was found.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.resolve_class(*args)</code>
        </li>
      
        <li class="covered" data-hits="271" data-linenumber="59">
          <span class="hits">271</span>
          
          <code class="ruby">    symbols, rest = args.partition{|x| x.kind_of? Symbol }</code>
        </li>
      
        <li class="covered" data-hits="101" data-linenumber="60">
          <span class="hits">101</span>
          
          <code class="ruby">    version = symbols.fetch(0, :default)</code>
        </li>
      
        <li class="covered" data-hits="101" data-linenumber="61">
          <span class="hits">101</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Unknown template version #{version.inspect}, defined versions: #{VERSIONS.keys.inspect}&quot; unless VERSIONS.key?(version)</code>
        </li>
      
        <li class="covered" data-hits="100" data-linenumber="62">
          <span class="hits">100</span>
          
          <code class="ruby">    return self.const_get(VERSIONS[version]), rest</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  # Creates an uri template using an implementation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  # The args should at least contain a pattern string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  # Symbols in the args are used to determine the actual implementation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  #   tpl = URITemplate.new('{x}') # a new template using the default implementation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  #   tpl.expand('x'=&gt;'y') #=&gt; 'y'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  #   tpl = URITemplate.new(:colon,'/:x') # a new template using the colon implementation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.new(*args)</code>
        </li>
      
        <li class="covered" data-hits="98" data-linenumber="77">
          <span class="hits">98</span>
          
          <code class="ruby">    klass, rest = resolve_class(*args)</code>
        </li>
      
        <li class="covered" data-hits="97" data-linenumber="78">
          <span class="hits">97</span>
          
          <code class="ruby">    return klass.new(*rest)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  # Tries to convert the given argument into an {URITemplate}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  # Returns nil if this fails.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  # @return [nil|{URITemplate}]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.try_convert(x)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="86">
          <span class="hits">7</span>
          
          <code class="ruby">    if x.kind_of? URITemplate</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">      return x</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="88">
          <span class="hits">5</span>
          
          <code class="ruby">    elsif x.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="89">
          <span class="hits">3</span>
          
          <code class="ruby">      return URITemplate.new(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  # Same as {.try_convert} but raises an ArgumentError when the given argument could not be converted.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  # @raise ArgumentError if the argument is unconvertable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  # @return {URITemplate}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.convert(x)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>
          
          <code class="ruby">    o = self.try_convert(x)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>
          
          <code class="ruby">    if o.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">      raise ArgumentError, &quot;Expected to receive something that can be converted to an URITemplate, but got #{x.inspect}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="104">
          <span class="hits">2</span>
          
          <code class="ruby">    return o</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  # Tries to coerce two URITemplates into a common representation.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  # Returns an array with two {URITemplate}s and two booleans indicating which of the two were converted or raises an ArgumentError.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  #   URITemplate.coerce( URITemplate.new(:rfc6570,'{x}'), '{y}' ) #=&gt; [URITemplate.new(:rfc6570,'{x}'), URITemplate.new(:rfc6570,'{y}'), false, true]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  #   URITemplate.coerce( '{y}', URITemplate.new(:rfc6570,'{x}') ) #=&gt; [URITemplate.new(:rfc6570,'{y}'), URITemplate.new(:rfc6570,'{x}'), true, false]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  # @return [Tuple&lt;URITemplate,URITemplate,Bool,Bool&gt;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.coerce(a,b)</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="116">
          <span class="hits">60</span>
          
          <code class="ruby">    if a.kind_of? URITemplate</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="117">
          <span class="hits">55</span>
          
          <code class="ruby">      if a.class == b.class</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="118">
          <span class="hits">30</span>
          
          <code class="ruby">        return [a,b,false,false]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="120">
          <span class="hits">25</span>
          
          <code class="ruby">      b_as_a = a.class.try_convert(b)</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="121">
          <span class="hits">25</span>
          
          <code class="ruby">      if b_as_a</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="122">
          <span class="hits">23</span>
          
          <code class="ruby">        return [a,b_as_a,false,true]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="125">
          <span class="hits">7</span>
          
          <code class="ruby">    if b.kind_of? URITemplate</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="126">
          <span class="hits">4</span>
          
          <code class="ruby">      a_as_b = b.class.try_convert(a)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="127">
          <span class="hits">4</span>
          
          <code class="ruby">      if a_as_b</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="128">
          <span class="hits">3</span>
          
          <code class="ruby">        return [a_as_b, b, true, false]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="131">
          <span class="hits">4</span>
          
          <code class="ruby">    bc = self.try_convert(b)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="132">
          <span class="hits">4</span>
          
          <code class="ruby">    if bc.kind_of? URITemplate</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="133">
          <span class="hits">3</span>
          
          <code class="ruby">      a_as_b = bc.class.try_convert(a)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="134">
          <span class="hits">3</span>
          
          <code class="ruby">      if a_as_b</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="135">
          <span class="hits">2</span>
          
          <code class="ruby">        return [a_as_b, bc, true, true]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="138">
          <span class="hits">2</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Expected at least on URITemplate, but got #{a.inspect} and #{b.inspect}&quot; unless a.kind_of? URITemplate or b.kind_of? URITemplate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Cannot coerce #{a.inspect} and #{b.inspect} into a common representation.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  # Applies a method to a URITemplate with another URITemplate as argument.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">  # This is a useful shorthand since both URITemplates are automatically coerced.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  #   tpl = URITemplate.new('foo')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">  #   URITemplate.apply( tpl, :/, 'bar' ).pattern #=&gt; 'foo/bar'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  #   URITemplate.apply( 'baz', :/, tpl ).pattern #=&gt; 'baz/foo'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">  #   URITemplate.apply( 'bla', :/, 'blub' ).pattern #=&gt; 'bla/blub'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.apply(a, method, b, *args)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="152">
          <span class="hits">3</span>
          
          <code class="ruby">    a,b,_,_ = self.coerce(a,b)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="153">
          <span class="hits">3</span>
          
          <code class="ruby">    a.send(method,b,*args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.coerce_first_arg(meth)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="157">
          <span class="hits">3</span>
          
          <code class="ruby">    alias_method( (meth.to_s + '_without_coercion').to_sym , meth )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="158">
          <span class="hits">3</span>
          
          <code class="ruby">    class_eval(&lt;&lt;-RUBY)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">def #{meth}(other, *args, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  this, other, this_converted, _ = URITemplate.coerce( self, other )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">  if this_converted</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    return this.#{meth}(other,*args, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  return #{meth}_without_coercion(other,*args, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">RUBY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  # A base class for all errors which will be raised upon invalid syntax.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>
          
          <code class="ruby">  module Invalid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  # A base class for all errors which will be raised when a variable value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">  # is not allowed for a certain expansion.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">  module InvalidValue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  # Expands this uri template with the given variables.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">  # The variables should be converted to strings using {Utils#object_to_param}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  # The keys in the variables hash are converted to</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  # strings in order to support the Ruby 1.9 hash syntax.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  # @raise {Unconvertable} if a variable could not be converted to a string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">  # @raise {InvalidValue} if a value is not suiteable for a certain variable ( e.g. a string when a list is expected ).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">  # @param variables [#map]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  # @return String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">  def expand(variables = {})</code>
        </li>
      
        <li class="covered" data-hits="297" data-linenumber="190">
          <span class="hits">297</span>
          
          <code class="ruby">    raise ArgumentError, &quot;Expected something that returns to :map, but got: #{variables.inspect}&quot; unless variables.respond_to? :map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    # Stringify variables</code>
        </li>
      
        <li class="covered" data-hits="1233" data-linenumber="193">
          <span class="hits">1233</span>
          
          <code class="ruby">    variables = Hash[variables.map{ |k, v| [k.to_s, v] }]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="297" data-linenumber="195">
          <span class="hits">297</span>
          
          <code class="ruby">    tokens.map{|part|</code>
        </li>
      
        <li class="covered" data-hits="389" data-linenumber="196">
          <span class="hits">389</span>
          
          <code class="ruby">      part.expand(variables)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    }.join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">  # @abstract</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">  # Returns the type of this template. The type is a symbol which can be used in {.resolve_class} to resolve the type of this template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">  # @return [Symbol]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">  def type</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">    raise &quot;Please implement #type on #{self.class.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">  # @abstract</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  # Returns the tokens of this templates. Tokens should include either {Literal} or {Expression}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">  # @return [Array&lt;URITemplate::Token&gt;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokens</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">    raise &quot;Please implement #tokens on #{self.class.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  # Returns an array containing all variables. Repeated variables are ignored. The concrete order of the variables may change.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">  #   URITemplate.new('{foo}{bar}{baz}').variables #=&gt; ['foo','bar','baz']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  #   URITemplate.new('{a}{c}{a}{b}').variables #=&gt; ['a','c','b']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">  # @return [Array&lt;String&gt;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>
          
          <code class="ruby">  def variables</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="223">
          <span class="hits">14</span>
          
          <code class="ruby">    @variables ||= tokens.map(&amp;:variables).flatten.uniq.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">  # Returns the number of static characters in this template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">  # This method is useful for routing, since it's often pointful to use the url with fewer variable characters.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  # For example 'static' and 'sta\\{var\\}' both match 'static', but in most cases 'static' should be prefered over 'sta\\{var\\}' since it's more specific.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  #   URITemplate.new('/xy/').static_characters #=&gt; 4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  #   URITemplate.new('{foo}').static_characters #=&gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  #   URITemplate.new('a{foo}b').static_characters #=&gt; 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">  # @return Numeric</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def static_characters</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="237">
          <span class="hits">6</span>
          
          <code class="ruby">    @static_characters ||= tokens.select(&amp;:literal?).map{|t| t.string.size }.inject(0,:+)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">  # Returns whether this uri-template includes a host name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">  # This method is usefull to check wheter this template will generate </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  # or match a uri with a host.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">  # @see #scheme?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">  #   URITemplate.new('/foo').host? #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">  #   URITemplate.new('//example.com/foo').host? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">  #   URITemplate.new('//{host}/foo').host? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">  #   URITemplate.new('http://example.com/foo').host? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">  #   URITemplate.new('{scheme}://example.com/foo').host? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>
          
          <code class="ruby">  def host?</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="255">
          <span class="hits">42</span>
          
          <code class="ruby">    return scheme_and_host[1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">  # Returns whether this uri-template includes a scheme</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  # This method is usefull to check wheter this template will generate </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">  # or match a uri with a scheme.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">  # @see #host?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">  #   URITemplate.new('/foo').scheme? #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">  #   URITemplate.new('//example.com/foo').scheme? #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  #   URITemplate.new('http://example.com/foo').scheme? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">  #   URITemplate.new('{scheme}://example.com/foo').scheme? #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">  def scheme?</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="272">
          <span class="hits">34</span>
          
          <code class="ruby">    return scheme_and_host[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">  # Returns the pattern for this template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">  # @return String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">  def pattern</code>
        </li>
      
        <li class="covered" data-hits="562" data-linenumber="279">
          <span class="hits">562</span>
          
          <code class="ruby">    @pattern ||= tokens.map(&amp;:to_s).join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">  alias to_s pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">  # Compares two template patterns.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="285">
          <span class="hits">1</span>
          
          <code class="ruby">  def eq(other)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="286">
          <span class="hits">20</span>
          
          <code class="ruby">    return self.pattern == other.pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="289">
          <span class="hits">1</span>
          
          <code class="ruby">  coerce_first_arg :eq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="291">
          <span class="hits">1</span>
          
          <code class="ruby">  alias == eq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">  # Tries to concatenate two templates, as if they were path segments.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">  # Removes double slashes or insert one if they are missing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">  #   tpl = URITemplate::RFC6570.new('/xy/')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">  #   (tpl / '/z/' ).pattern #=&gt; '/xy/z/'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">  #   (tpl / 'z/' ).pattern #=&gt; '/xy/z/'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  #   (tpl / '{/z}' ).pattern #=&gt; '/xy{/z}'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">  #   (tpl / 'a' / 'b' ).pattern #=&gt; '/xy/a/b'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  # @param other [URITemplate, String, ...]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">  # @return URITemplate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">  def path_concat(other)</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="306">
          <span class="hits">28</span>
          
          <code class="ruby">    if other.host? or other.scheme?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="307">
          <span class="hits">2</span>
          
          <code class="ruby">      raise ArgumentError, &quot;Expected to receive a relative template but got an absoulte one: #{other.inspect}. If you think this is a bug, please report it.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="310">
          <span class="hits">26</span>
          
          <code class="ruby">    return self if other.tokens.none?</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="311">
          <span class="hits">25</span>
          
          <code class="ruby">    return other if self.tokens.none?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="313">
          <span class="hits">24</span>
          
          <code class="ruby">    tail = self.tokens.last</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="314">
          <span class="hits">24</span>
          
          <code class="ruby">    head = other.tokens.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="316">
          <span class="hits">24</span>
          
          <code class="ruby">    if tail.ends_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="317">
          <span class="hits">11</span>
          
          <code class="ruby">      if head.starts_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="318">
          <span class="hits">7</span>
          
          <code class="ruby">        return self.class.new( remove_double_slash(self.tokens, other.tokens).join )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">    elsif !head.starts_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="321">
          <span class="hits">6</span>
          
          <code class="ruby">      return self.class.new( (self.tokens + ['/'] + other.tokens).join)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="323">
          <span class="hits">11</span>
          
          <code class="ruby">    return self.class.new( (self.tokens + other.tokens).join )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="326">
          <span class="hits">1</span>
          
          <code class="ruby">  coerce_first_arg :path_concat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">  alias / path_concat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">  # Concatenate two template with conversion.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">  #   tpl = URITemplate::RFC6570.new('foo')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  #   (tpl + '{bar}' ).pattern #=&gt; 'foo{bar}'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">  # @param other [URITemplate, String, ...]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">  # @return URITemplate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="338">
          <span class="hits">1</span>
          
          <code class="ruby">  def concat(other)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="339">
          <span class="hits">3</span>
          
          <code class="ruby">    if other.host? or other.scheme?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">      raise ArgumentError, &quot;Expected to receive a relative template but got an absoulte one: #{other.inspect}. If you think this is a bug, please report it.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="343">
          <span class="hits">3</span>
          
          <code class="ruby">    return self if other.tokens.none?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="344">
          <span class="hits">3</span>
          
          <code class="ruby">    return other if self.tokens.none?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="345">
          <span class="hits">3</span>
          
          <code class="ruby">    return self.class.new( self.to_s + other.to_s )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="348">
          <span class="hits">1</span>
          
          <code class="ruby">  coerce_first_arg :concat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="350">
          <span class="hits">1</span>
          
          <code class="ruby">  alias + concat</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="351">
          <span class="hits">1</span>
          
          <code class="ruby">  alias &gt;&gt; concat</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">  # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="354">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_double_slash( first_tokens, second_tokens )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="355">
          <span class="hits">7</span>
          
          <code class="ruby">    if first_tokens.last.literal?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="356">
          <span class="hits">6</span>
          
          <code class="ruby">      return first_tokens[0..-2] + [ first_tokens.last.to_s[0..-2] ] + second_tokens</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">    elsif second_tokens.first.literal?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="358">
          <span class="hits">1</span>
          
          <code class="ruby">      return first_tokens + [ second_tokens.first.to_s[1..-1] ] + second_tokens[1..-1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">      raise ArgumentError, &quot;Cannot remove double slashes from #{first_tokens.inspect} and #{second_tokens.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="364">
          <span class="hits">1</span>
          
          <code class="ruby">  private :remove_double_slash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">  # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="367">
          <span class="hits">1</span>
          
          <code class="ruby">  def scheme_and_host</code>
        </li>
      
        <li class="covered" data-hits="76" data-linenumber="368">
          <span class="hits">76</span>
          
          <code class="ruby">    return @scheme_and_host if @scheme_and_host</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="369">
          <span class="hits">47</span>
          
          <code class="ruby">    read_chars = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="370">
          <span class="hits">47</span>
          
          <code class="ruby">    @scheme_and_host = [false,false]</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="371">
          <span class="hits">47</span>
          
          <code class="ruby">    tokens.each do |token|</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="372">
          <span class="hits">51</span>
          
          <code class="ruby">      if token.expression?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="373">
          <span class="hits">14</span>
          
          <code class="ruby">        read_chars &lt;&lt; &quot;x&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="374">
          <span class="hits">14</span>
          
          <code class="ruby">        if token.scheme?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="375">
          <span class="hits">2</span>
          
          <code class="ruby">          read_chars &lt;&lt; ':'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="377">
          <span class="hits">14</span>
          
          <code class="ruby">        if token.host?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="378">
          <span class="hits">2</span>
          
          <code class="ruby">          read_chars &lt;&lt; '//'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="380">
          <span class="hits">14</span>
          
          <code class="ruby">        read_chars &lt;&lt; &quot;x&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">      elsif token.literal?</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="382">
          <span class="hits">37</span>
          
          <code class="ruby">        read_chars &lt;&lt; token.string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="384">
          <span class="hits">51</span>
          
          <code class="ruby">      if read_chars =~ SCHEME_REGEX</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="385">
          <span class="hits">9</span>
          
          <code class="ruby">        @scheme_and_host = [true, true]</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="386">
          <span class="hits">9</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">      elsif read_chars =~ HOST_REGEX</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="388">
          <span class="hits">6</span>
          
          <code class="ruby">        @scheme_and_host[1] = true</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="389">
          <span class="hits">6</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">      elsif read_chars =~ /(^|[^:\/])\/(?!\/)/</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="391">
          <span class="hits">16</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="394">
          <span class="hits">47</span>
          
          <code class="ruby">    return @scheme_and_host</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="397">
          <span class="hits">1</span>
          
          <code class="ruby">  private :scheme_and_host</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="399">
          <span class="hits">1</span>
          
          <code class="ruby">  alias absolute? host?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">  # Opposite of {#absolute?}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="402">
          <span class="hits">1</span>
          
          <code class="ruby">  def relative?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">    !absolute?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9fa8ad920a79b98903cb57c06430e4f7a4b80337">
  <div class="header">
    <h3>lib/uri_template/colon.rb</h3>
    <h4><span class="green">97.83 %</span> covered</h4>
    <div>
      <b>92</b> relevant lines. 
      <span class="green"><b>90</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'forwardable'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/utils'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"># A colon based template denotes variables with a colon.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"># This template type is somewhat compatible with sinatra.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"># @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">#   tpl = URITemplate::Colon.new('/foo/:bar')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">#   tpl.extract('/foo/baz') #=&gt; {'bar'=&gt;'baz'}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">#   tpl.expand('bar'=&gt;'boom') #=&gt; '/foo/boom'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">class Colon</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  include URITemplate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  VAR = /(?:\{:([a-z]+)\}|:([a-z]+)(?![a-z])|\*)/u</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  class InvalidValue &lt; StandardError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    include URITemplate::InvalidValue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :variable, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(variable, value)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">      @variable = variable</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">      @value = value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">      super(generate_message())</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    class SplatIsNotAnArray &lt; self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    def generate_message()</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">      return &quot;The template variable &quot; + variable.inspect + &quot; cannot expand the given value &quot;+ value.inspect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  class Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    class Variable &lt; self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">      include URITemplate::Expression</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">      attr_reader :name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">      def initialize(name)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="72">
          <span class="hits">26</span>
          
          <code class="ruby">        @name = name</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="73">
          <span class="hits">26</span>
          
          <code class="ruby">        @variables = [name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      def expand(vars)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="77">
          <span class="hits">3</span>
          
          <code class="ruby">        return Utils.escape_url(Utils.object_to_param(vars[name]))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_r</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="81">
          <span class="hits">8</span>
          
          <code class="ruby">        return '([^/]*?)'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_s</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="85">
          <span class="hits">3</span>
          
          <code class="ruby">        return &quot;:#{name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    class Splat &lt; Variable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">      SPLAT = 'splat'.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">      attr_reader :index</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">      def initialize(index)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="97">
          <span class="hits">9</span>
          
          <code class="ruby">        @index = index</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="98">
          <span class="hits">9</span>
          
          <code class="ruby">        super(SPLAT)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">      def expand(vars)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="102">
          <span class="hits">5</span>
          
          <code class="ruby">        var = vars[name]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="103">
          <span class="hits">5</span>
          
          <code class="ruby">        if Array === var</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="104">
          <span class="hits">4</span>
          
          <code class="ruby">          return Utils.escape_uri(Utils.object_to_param(var[index]))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">          raise InvalidValue::SplatIsNotAnArray.new(name,var)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_r</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="111">
          <span class="hits">4</span>
          
          <code class="ruby">        return '(.+?)'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    class Static &lt; self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">      include URITemplate::Literal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">      def initialize(str)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="121">
          <span class="hits">42</span>
          
          <code class="ruby">        @string = str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">      def expand(_)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="125">
          <span class="hits">11</span>
          
          <code class="ruby">        return @string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_r</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="129">
          <span class="hits">21</span>
          
          <code class="ruby">        return Regexp.escape(@string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  # Tries to convert the value into a colon-template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  #   URITemplate::Colon.try_convert('/foo/:bar/').pattern #=&gt; '/foo/:bar/'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  #   URITemplate::Colon.try_convert(URITemplate.new(:rfc6570, '/foo/{bar}/')).pattern #=&gt; '/foo/{:bar}/'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.try_convert(x)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="143">
          <span class="hits">7</span>
          
          <code class="ruby">    if x.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="144">
          <span class="hits">2</span>
          
          <code class="ruby">      return new(x)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="145">
          <span class="hits">5</span>
          
          <code class="ruby">    elsif x.kind_of? self</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">      return x</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="147">
          <span class="hits">5</span>
          
          <code class="ruby">    elsif x.kind_of? URITemplate::RFC6570 and x.level == 1</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="148">
          <span class="hits">6</span>
          
          <code class="ruby">      return new( x.pattern.gsub(/\{(.*?)\}/u){ &quot;{:#{$1}}&quot; } )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(pattern)</code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="155">
          <span class="hits">50</span>
          
          <code class="ruby">    raise ArgumentError,&quot;Expected a String but got #{pattern.inspect}&quot; unless pattern.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="156">
          <span class="hits">49</span>
          
          <code class="ruby">    @pattern = pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">  # Extracts variables from an uri.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">  # @param uri [String]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  # @return nil,Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="163">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract(uri)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="164">
          <span class="hits">16</span>
          
          <code class="ruby">    md = self.to_r.match(uri)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="165">
          <span class="hits">16</span>
          
          <code class="ruby">    return nil unless md</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="166">
          <span class="hits">13</span>
          
          <code class="ruby">    result = {}</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="167">
          <span class="hits">13</span>
          
          <code class="ruby">    splat = []</code>
        </li>
      
        <li class="covered" data-hits="43" data-linenumber="168">
          <span class="hits">43</span>
          
          <code class="ruby">    self.tokens.select{|tk| tk.kind_of? URITemplate::Expression }.each_with_index do |tk,i|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="169">
          <span class="hits">12</span>
          
          <code class="ruby">      if tk.kind_of? Token::Splat</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="170">
          <span class="hits">5</span>
          
          <code class="ruby">        splat &lt;&lt; md[i+1]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="171">
          <span class="hits">5</span>
          
          <code class="ruby">        result['splat'] = splat unless result.key? 'splat'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="173">
          <span class="hits">7</span>
          
          <code class="ruby">        result[tk.name] = Utils.unescape_url( md[i+1] )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="176">
          <span class="hits">13</span>
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="177">
          <span class="hits">2</span>
          
          <code class="ruby">      return yield(result)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="179">
          <span class="hits">11</span>
          
          <code class="ruby">    return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">  def type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">    :colon</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_r</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="187">
          <span class="hits">16</span>
          
          <code class="ruby">    @regexp ||= Regexp.new('\A' + tokens.map(&amp;:to_r).join + '\z', Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokens</code>
        </li>
      
        <li class="covered" data-hits="78" data-linenumber="191">
          <span class="hits">78</span>
          
          <code class="ruby">    @tokens ||= tokenize!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokenize!</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="197">
          <span class="hits">36</span>
          
          <code class="ruby">    number_of_splats = 0</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="198">
          <span class="hits">36</span>
          
          <code class="ruby">    RegexpEnumerator.new(VAR).each(@pattern).map{|x|</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="199">
          <span class="hits">68</span>
          
          <code class="ruby">      if x.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="200">
          <span class="hits">42</span>
          
          <code class="ruby">        Token::Static.new(Utils.escape_uri(x))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      elsif x[0] == '*'</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="202">
          <span class="hits">9</span>
          
          <code class="ruby">        n = number_of_splats</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="203">
          <span class="hits">9</span>
          
          <code class="ruby">        number_of_splats = number_of_splats + 1</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="204">
          <span class="hits">9</span>
          
          <code class="ruby">        Token::Splat.new(n)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">        # TODO: when rubinius supports ambigious names this could be replaced with x['name'] *sigh*</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="207">
          <span class="hits">17</span>
          
          <code class="ruby">        Token::Variable.new(x[1] || x[2])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">    }.to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e4fdda42d3ce208ff79e2b3bdac126cf303e9a14">
  <div class="header">
    <h3>lib/uri_template/expression.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># A module which all non-literal tokens should include.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate::Expression</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  include URITemplate::Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :variables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def literal?</code>
        </li>
      
        <li class="covered" data-hits="427" data-linenumber="26">
          <span class="hits">427</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def expression?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="30">
          <span class="hits">14</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5b9692d9a3b0142a10ad55a44c886cc746f796eb">
  <div class="header">
    <h3>lib/uri_template/literal.rb</h3>
    <h4><span class="green">94.12 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># A module which all literal tokens should include.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate::Literal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  include URITemplate::Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  SLASH = ?/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def literal?</code>
        </li>
      
        <li class="covered" data-hits="118" data-linenumber="28">
          <span class="hits">118</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def expression?</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="32">
          <span class="hits">37</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def expand(_)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="40">
          <span class="hits">58</span>
          
          <code class="ruby">    return string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def starts_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="44">
          <span class="hits">20</span>
          
          <code class="ruby">    string[0] == SLASH</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def ends_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="48">
          <span class="hits">19</span>
          
          <code class="ruby">    string[-1] == SLASH</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  alias to_s string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2fab4ed61bea47f8f91639421b60422e1e1dc724">
  <div class="header">
    <h3>lib/uri_template/rfc6570.rb</h3>
    <h4><span class="green">93.55 %</span> covered</h4>
    <div>
      <b>155</b> relevant lines. 
      <span class="green"><b>145</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'strscan'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">require 'set'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">require 'forwardable'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/utils'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"># A uri template which should comply with the rfc 6570 ( http://tools.ietf.org/html/rfc6570 ).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"># @note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">#   Most specs and examples refer to this class directly, because they are acutally refering to this specific implementation. If you just want uri templates, you should rather use the methods on {URITemplate} to create templates since they will select an implementation.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">class URITemplate::RFC6570</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  TYPE = :rfc6570</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  include URITemplate</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  extend Forwardable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  Utils = URITemplate::Utils</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  if Utils.use_unicode?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    # @private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    #                           \/ - unicode ctrl-chars</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    LITERAL = /([^&quot;'%&lt;&gt;\\^`{|}\u0000-\u001F\u007F-\u009F\s]|%[0-9a-fA-F]{2})+/u</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    # @private</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    LITERAL = Regexp.compile('([^&quot;\'%&lt;&gt;\\\\^`{|}\x00-\x1F\x7F-\x9F\s]|%[0-9a-fA-F]{2})+',Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  CHARACTER_CLASSES = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    :unreserved =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      :class =&gt; '(?:[A-Za-z0-9\-\._]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      :class_with_comma =&gt; '(?:[A-Za-z0-9\-\._,]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      :class_without_comma =&gt; '(?:[A-Za-z0-9\-\._]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      :grabs_comma =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    :unreserved_reserved_pct =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      :class =&gt; '(?:[A-Za-z0-9\-\._:\/?#\[\]@!\$%\'\(\)*+,;=]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">      :class_with_comma =&gt; '(?:[A-Za-z0-9\-\._:\/?#\[\]@!\$%\'\(\)*+,;=]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      :class_without_comma =&gt; '(?:[A-Za-z0-9\-\._:\/?#\[\]@!\$%\'\(\)*+;=]|%[0-9a-fA-F]{2})',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      :grabs_comma =&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    :varname =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      :class =&gt; '(?:[A-Za-z0-9\-\._]|%[0-9a-fA-F]{2})+',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      :class_name =&gt; 'c_vn_'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  # Specifies that no processing should be done upon extraction.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  # @see #extract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  NO_PROCESSING = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # Specifies that the extracted values should be processed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # @see #extract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  CONVERT_VALUES = [:convert_values]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  # Specifies that the extracted variable list should be processed.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  # @see #extract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  CONVERT_RESULT = [:convert_result]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  # Default processing. Means: convert values and the list itself.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  # @see #extract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  DEFAULT_PROCESSING = CONVERT_VALUES + CONVERT_RESULT</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  VAR = Regexp.compile(&lt;&lt;'__REGEXP__'.strip, Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">((?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2})(?:\.?(?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2}))*)(\*)?(?::(\d+))?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">__REGEXP__</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  EXPRESSION = Regexp.compile(&lt;&lt;'__REGEXP__'.strip, Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">\{([+#\./;?&amp;]?)((?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2})(?:\.?(?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2}))*\*?(?::\d+)?(?:,(?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2})(?:\.?(?:[a-zA-Z0-9_]|%[0-9a-fA-F]{2}))*\*?(?::\d+)?)*)\}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">__REGEXP__</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  URI = Regexp.compile(&lt;&lt;__REGEXP__.strip, Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">\\A(#{LITERAL.source}|#{EXPRESSION.source})*\\z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">__REGEXP__</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  class Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  class Literal &lt; Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    include URITemplate::Literal</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(string)</code>
        </li>
      
        <li class="covered" data-hits="187" data-linenumber="111">
          <span class="hits">187</span>
          
          <code class="ruby">      @string = string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">    def level</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="115">
          <span class="hits">17</span>
          
          <code class="ruby">      1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">    def arity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">      0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_r_source(*_)</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="123">
          <span class="hits">39</span>
          
          <code class="ruby">      Regexp.escape(@string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_s</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="127">
          <span class="hits">37</span>
          
          <code class="ruby">      @string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  # This error is raised when an invalid pattern was given.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  class Invalid &lt; StandardError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">    include URITemplate::Invalid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :pattern, :position</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(source, position)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="140">
          <span class="hits">24</span>
          
          <code class="ruby">      @pattern = source</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="141">
          <span class="hits">24</span>
          
          <code class="ruby">      @position = position</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="142">
          <span class="hits">24</span>
          
          <code class="ruby">      super(&quot;Invalid expression found in #{source.inspect} at #{position}: '#{source[position..-1]}'&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">  class InvalidValue &lt; StandardError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">    include URITemplate::InvalidValue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :variable, :value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(variable, value)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="154">
          <span class="hits">4</span>
          
          <code class="ruby">      @variable = variable</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="155">
          <span class="hits">4</span>
          
          <code class="ruby">      @value = value</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="156">
          <span class="hits">4</span>
          
          <code class="ruby">      super(generate_message())</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">    def generate_message()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">      return &quot;The template variable &quot; + variable.inspect + &quot; cannot expand the given value &quot;+ value.inspect</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="166">
          <span class="hits">1</span>
          
          <code class="ruby">  class InvalidValue::LengthLimitInapplicable &lt; InvalidValue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">    def generate_message()</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="170">
          <span class="hits">4</span>
          
          <code class="ruby">      return &quot;The template variable &quot;+variable.inspect+&quot; has a length limit and therefore cannot expand an associative value (&quot;+value.inspect+&quot;).&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  class Tokenizer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">    include Enumerable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(source, ops)</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="183">
          <span class="hits">477</span>
          
          <code class="ruby">      @source = source</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="184">
          <span class="hits">477</span>
          
          <code class="ruby">      @operators = ops</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">    def each</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="188">
          <span class="hits">477</span>
          
          <code class="ruby">      scanner = StringScanner.new(@source)</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="189">
          <span class="hits">477</span>
          
          <code class="ruby">      until scanner.eos?</code>
        </li>
      
        <li class="covered" data-hits="606" data-linenumber="190">
          <span class="hits">606</span>
          
          <code class="ruby">        expression = scanner.scan(EXPRESSION)</code>
        </li>
      
        <li class="covered" data-hits="606" data-linenumber="191">
          <span class="hits">606</span>
          
          <code class="ruby">        if expression</code>
        </li>
      
        <li class="covered" data-hits="400" data-linenumber="192">
          <span class="hits">400</span>
          
          <code class="ruby">          vars = scanner[2].split(',').map{|name|</code>
        </li>
      
        <li class="covered" data-hits="511" data-linenumber="193">
          <span class="hits">511</span>
          
          <code class="ruby">            match = VAR.match(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">            # 1 = varname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">            # 2 = explode</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">            # 3 = length</code>
        </li>
      
        <li class="covered" data-hits="511" data-linenumber="197">
          <span class="hits">511</span>
          
          <code class="ruby">            [ match[1], match[2] == '*', match[3].to_i ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="covered" data-hits="400" data-linenumber="199">
          <span class="hits">400</span>
          
          <code class="ruby">          yield @operators[scanner[1]].new(vars)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="206" data-linenumber="201">
          <span class="hits">206</span>
          
          <code class="ruby">          literal = scanner.scan(LITERAL)</code>
        </li>
      
        <li class="covered" data-hits="206" data-linenumber="202">
          <span class="hits">206</span>
          
          <code class="ruby">          if literal</code>
        </li>
      
        <li class="covered" data-hits="182" data-linenumber="203">
          <span class="hits">182</span>
          
          <code class="ruby">            yield(Literal.new(literal))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="205">
          <span class="hits">24</span>
          
          <code class="ruby">            raise Invalid.new(@source,scanner.pos)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">  # The class methods for all rfc6570 templates.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>
          
          <code class="ruby">  module ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    # Tries to convert the given param in to a instance of {RFC6570}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">    # It basically passes thru instances of that class, parses strings and return nil on everything else.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.try_convert( Object.new ) #=&gt; nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">    #   tpl = URITemplate::RFC6570.new('{foo}')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.try_convert( tpl ) #=&gt; tpl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.try_convert('{foo}') #=&gt; tpl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.try_convert(URITemplate.new(:colon, ':foo')) #=&gt; tpl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">    #   # This pattern is invalid, so it wont be parsed:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.try_convert('{foo') #=&gt; nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">    def try_convert(x)</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="229">
          <span class="hits">33</span>
          
          <code class="ruby">      if x.class == self</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">        return x</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="231">
          <span class="hits">32</span>
          
          <code class="ruby">      elsif x.kind_of? String and valid? x</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="232">
          <span class="hits">21</span>
          
          <code class="ruby">        return new(x)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="233">
          <span class="hits">11</span>
          
          <code class="ruby">      elsif x.kind_of? URITemplate::Colon</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="234">
          <span class="hits">16</span>
          
          <code class="ruby">        return nil if x.tokens.any?{|tk| tk.kind_of? URITemplate::Colon::Token::Splat }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">        return new( x.tokens.map{|tk|</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="236">
          <span class="hits">9</span>
          
          <code class="ruby">          if tk.literal?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="237">
          <span class="hits">5</span>
          
          <code class="ruby">            Literal.new(tk.string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="239">
          <span class="hits">4</span>
          
          <code class="ruby">            Expression.new([[tk.variables.first, false, 0]])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="241">
          <span class="hits">7</span>
          
          <code class="ruby">        })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">    # Tests whether a given pattern is a valid template pattern.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.valid? 'foo' #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.valid? '{foo}' #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    #   URITemplate::RFC6570.valid? '{foo' #=&gt; false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="252">
          <span class="hits">1</span>
          
          <code class="ruby">    def valid?(pattern)</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="253">
          <span class="hits">25</span>
          
          <code class="ruby">      URI === pattern</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="258">
          <span class="hits">1</span>
          
          <code class="ruby">  extend ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  # @param pattern_or_tokens [String,Array] either a pattern as String or an Array of tokens</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">  # @param options [Hash] some options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  # @option :lazy [true,false] If true the pattern will be parsed on first access, this also means that syntax errors will not be detected unless accessed.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="265">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(pattern_or_tokens,options={})</code>
        </li>
      
        <li class="covered" data-hits="489" data-linenumber="266">
          <span class="hits">489</span>
          
          <code class="ruby">    @options = options.dup.freeze</code>
        </li>
      
        <li class="covered" data-hits="489" data-linenumber="267">
          <span class="hits">489</span>
          
          <code class="ruby">    if pattern_or_tokens.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="268">
          <span class="hits">477</span>
          
          <code class="ruby">      @pattern = pattern_or_tokens.dup</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="269">
          <span class="hits">477</span>
          
          <code class="ruby">      @pattern.freeze</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="270">
          <span class="hits">477</span>
          
          <code class="ruby">      unless @options[:lazy]</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="271">
          <span class="hits">477</span>
          
          <code class="ruby">        self.tokens</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="273">
          <span class="hits">12</span>
          
          <code class="ruby">    elsif pattern_or_tokens.kind_of? Array</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="274">
          <span class="hits">11</span>
          
          <code class="ruby">      @tokens = pattern_or_tokens.dup</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="275">
          <span class="hits">11</span>
          
          <code class="ruby">      @tokens.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="277">
          <span class="hits">1</span>
          
          <code class="ruby">      raise ArgumentError, &quot;Expected to receive a pattern string, but got #{pattern_or_tokens.inspect}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">  # @method expand(variables = {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">  # Expands the template with the given variables.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">  # The expansion should be compatible to uritemplate spec rfc 6570 ( http://tools.ietf.org/html/rfc6570 ).</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">  # @note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">  #   All keys of the supplied hash should be strings as anything else won't be recognised.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">  # @note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  #   There are neither default values for variables nor will anything be raised if a variable is missing. Please read the spec if you want to know how undefined variables are handled.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{foo}').expand('foo'=&gt;'bar') #=&gt; 'bar'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{?args*}').expand('args'=&gt;{'key'=&gt;'value'}) #=&gt; '?key=value'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{undef}').expand() #=&gt; ''</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">  # @param variables [Hash]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">  # @return String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">  # Compiles this template into a regular expression which can be used to test whether a given uri matches this template. This template is also used for {#===}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">  #   tpl = URITemplate::RFC6570.new('/foo/{bar}/')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  #   regex = tpl.to_r</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">  #   regex === '/foo/baz/' #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">  #   regex === '/foz/baz/' #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">  # @return Regexp</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_r</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">    @regexp ||= begin</code>
        </li>
      
        <li class="covered" data-hits="202" data-linenumber="307">
          <span class="hits">202</span>
          
          <code class="ruby">      source = tokens.map(&amp;:to_r_source)</code>
        </li>
      
        <li class="covered" data-hits="202" data-linenumber="308">
          <span class="hits">202</span>
          
          <code class="ruby">      source.unshift('\A')</code>
        </li>
      
        <li class="covered" data-hits="202" data-linenumber="309">
          <span class="hits">202</span>
          
          <code class="ruby">      source.push('\z')</code>
        </li>
      
        <li class="covered" data-hits="202" data-linenumber="310">
          <span class="hits">202</span>
          
          <code class="ruby">      Regexp.new( source.join, Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="311">
          <span class="hits">387</span>
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">  # Extracts variables from a uri ( given as string ) or an instance of MatchData ( which was matched by the regexp of this template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">  # The actual result depends on the value of post_processing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">  # This argument specifies whether pair arrays should be converted to hashes.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">  # @example Default Processing</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{var}').extract('value') #=&gt; {'var'=&gt;'value'}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{&amp;args*}').extract('&amp;a=1&amp;b=2') #=&gt; {'args'=&gt;{'a'=&gt;'1','b'=&gt;'2'}}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{&amp;arg,arg}').extract('&amp;arg=1&amp;arg=2') #=&gt; {'arg'=&gt;'2'}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">  # @example No Processing</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{var}').extract('value', URITemplate::RFC6570::NO_PROCESSING) #=&gt; [['var','value']]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{&amp;args*}').extract('&amp;a=1&amp;b=2', URITemplate::RFC6570::NO_PROCESSING) #=&gt; [['args',[['a','1'],['b','2']]]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('{&amp;arg,arg}').extract('&amp;arg=1&amp;arg=2', URITemplate::RFC6570::NO_PROCESSING) #=&gt; [['arg','1'],['arg','2']]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">  # @raise Encoding::InvalidByteSequenceError when the given uri was not properly encoded.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">  # @raise Encoding::UndefinedConversionError when the given uri could not be converted to utf-8.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">  # @raise Encoding::CompatibilityError when the given uri could not be converted to utf-8.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">  # @param uri_or_match [String,MatchData] Uri_or_MatchData A uri or a matchdata from which the variables should be extracted.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">  # @param post_processing [Array] Processing Specifies which processing should be done.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">  # @note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">  #   Don't expect that an extraction can fully recover the expanded variables. Extract rather generates a variable list which should expand to the uri from which it were extracted. In general the following equation should hold true:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">  #     a_tpl.expand( a_tpl.extract( an_uri ) ) == an_uri</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">  # @example Extraction cruces</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">  #   two_lists = URITemplate::RFC6570.new('{listA*,listB*}')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">  #   uri = two_lists.expand('listA'=&gt;[1,2],'listB'=&gt;[3,4]) #=&gt; &quot;1,2,3,4&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">  #   variables = two_lists.extract( uri ) #=&gt; {'listA'=&gt;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;],'listB'=&gt;[&quot;4&quot;]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">  #   # However, like said in the note:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">  #   two_lists.expand( variables ) == uri #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">  # @note</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  #   The current implementation drops duplicated variables instead of checking them.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">  #   </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="349">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract(uri_or_match, post_processing = DEFAULT_PROCESSING )</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="350">
          <span class="hits">385</span>
          
          <code class="ruby">    if uri_or_match.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="384" data-linenumber="351">
          <span class="hits">384</span>
          
          <code class="ruby">      m = self.to_r.match(uri_or_match)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">    elsif uri_or_match.kind_of?(MatchData)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="353">
          <span class="hits">1</span>
          
          <code class="ruby">      if uri_or_match.respond_to?(:regexp) and uri_or_match.regexp != self.to_r</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">        raise ArgumentError, &quot;Trying to extract variables from MatchData which was not generated by this template.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">      m = uri_or_match</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">    elsif uri_or_match.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">      raise ArgumentError, &quot;Expected to receive a String or a MatchData, but got #{uri_or_match.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="385" data-linenumber="362">
          <span class="hits">385</span>
          
          <code class="ruby">    if m.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="365">
          <span class="hits">382</span>
          
          <code class="ruby">      result = extract_matchdata(m, post_processing)</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="366">
          <span class="hits">382</span>
          
          <code class="ruby">      if block_given?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="367">
          <span class="hits">2</span>
          
          <code class="ruby">        return yield result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="380" data-linenumber="370">
          <span class="hits">380</span>
          
          <code class="ruby">      return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">  # Extracts variables without any proccessing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">  # This is equivalent to {#extract} with options {NO_PROCESSING}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">  # @see #extract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="377">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_simple(uri_or_match)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="378">
          
          
          <code class="ruby">    extract( uri_or_match, NO_PROCESSING )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">  # @method ===(uri)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">  # Alias for to_r.=== . Tests whether this template matches a given uri.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">  # @return TrueClass, FalseClass</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="384">
          <span class="hits">1</span>
          
          <code class="ruby">  def_delegators :to_r, :===</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">  # @method match(uri)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby">  # Alias for to_r.match . Matches this template against the given uri.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="388">
          
          
          <code class="ruby">  # @yield MatchData</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby">  # @return MatchData, Object </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="390">
          <span class="hits">1</span>
          
          <code class="ruby">  def_delegators :to_r, :match</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">  # The type of this template.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">  #   tpl1 = URITemplate::RFC6570.new('/foo')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">  #   tpl2 = URITemplate.new( tpl1.pattern, tpl1.type )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">  #   tpl1 == tpl2 #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby">  # @see {URITemplate#type}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="400">
          <span class="hits">1</span>
          
          <code class="ruby">  def type</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="401">
          <span class="hits">9</span>
          
          <code class="ruby">    self.class::TYPE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">  # Returns the level of this template according to the rfc 6570 ( http://tools.ietf.org/html/rfc6570#section-1.2 ). Higher level means higher complexity.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">  # Basically this is defined as:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">  # * Level 1: no operators, one variable per expansion, no variable modifiers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby">  # * Level 2: '+' and '#' operators, one variable per expansion, no variable modifiers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby">  # * Level 3: all operators, multiple variables per expansion, no variable modifiers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby">  # * Level 4: all operators, multiple variables per expansion, all variable modifiers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby">  # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo/').level #=&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{bar}').level #=&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{#bar}').level #=&gt; 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{.bar}').level #=&gt; 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{bar,baz}').level #=&gt; 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{bar:20}').level #=&gt; 4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby">  #   URITemplate::RFC6570.new('/foo{bar*}').level #=&gt; 4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby">  # Templates of lower levels might be convertible to other formats while templates of higher levels might be incompatible. Level 1 for example should be convertible to any other format since it just contains simple expansions.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="423">
          <span class="hits">1</span>
          
          <code class="ruby">  def level</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="424">
          <span class="hits">30</span>
          
          <code class="ruby">    tokens.map(&amp;:level).max</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">  # Returns an array containing a the template tokens.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="428">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokens</code>
        </li>
      
        <li class="covered" data-hits="1575" data-linenumber="429">
          <span class="hits">1575</span>
          
          <code class="ruby">    @tokens ||= tokenize!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="432">
          <span class="hits">1</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="434">
          <span class="hits">1</span>
          
          <code class="ruby">  def tokenize!</code>
        </li>
      
        <li class="covered" data-hits="477" data-linenumber="435">
          <span class="hits">477</span>
          
          <code class="ruby">    self.class::Tokenizer.new(pattern, self.class::OPERATORS).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="438">
          <span class="hits">1</span>
          
          <code class="ruby">  def arity</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">    @arity ||= tokens.inject(0){|a,t| a + t.arity }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="443">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_matchdata(matchdata, post_processing)</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="444">
          <span class="hits">382</span>
          
          <code class="ruby">    bc = 1</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="445">
          <span class="hits">382</span>
          
          <code class="ruby">    vars = []</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="446">
          <span class="hits">382</span>
          
          <code class="ruby">    tokens.each{|part|</code>
        </li>
      
        <li class="covered" data-hits="486" data-linenumber="447">
          <span class="hits">486</span>
          
          <code class="ruby">      next if part.literal?</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="448">
          <span class="hits">420</span>
          
          <code class="ruby">      i = 0</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="449">
          <span class="hits">420</span>
          
          <code class="ruby">      pa = part.arity</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="450">
          <span class="hits">420</span>
          
          <code class="ruby">      while i &lt; pa</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="451">
          <span class="hits">554</span>
          
          <code class="ruby">        vars.push( *part.extract(i, matchdata[bc]) )</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="452">
          <span class="hits">554</span>
          
          <code class="ruby">        bc += 1</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="453">
          <span class="hits">554</span>
          
          <code class="ruby">        i += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="382" data-linenumber="456">
          <span class="hits">382</span>
          
          <code class="ruby">    if post_processing.include? :convert_result</code>
        </li>
      
        <li class="covered" data-hits="379" data-linenumber="457">
          <span class="hits">379</span>
          
          <code class="ruby">      if post_processing.include? :convert_values</code>
        </li>
      
        <li class="covered" data-hits="929" data-linenumber="458">
          <span class="hits">929</span>
          
          <code class="ruby">        return Hash[ vars.map!{|k,v| [k,Utils.pair_array_to_hash(v)] } ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">        return Hash[vars]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="461">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="463">
          <span class="hits">3</span>
          
          <code class="ruby">      if post_processing.include? :convert_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">        return vars.collect{|k,v| [k,Utils.pair_array_to_hash(v)] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="466">
          <span class="hits">3</span>
          
          <code class="ruby">        return vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="469">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="473">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570/regex_builder.rb'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="474">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570/expression.rb'</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4a47c80e51df05715b69056531364f778bce472e">
  <div class="header">
    <h3>lib/uri_template/rfc6570/expression.rb</h3>
    <h4><span class="green">98.98 %</span> covered</h4>
    <div>
      <b>196</b> relevant lines. 
      <span class="green"><b>194</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">class URITemplate::RFC6570</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression &lt; Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    include URITemplate::Expression</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :variables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(vars)</code>
        </li>
      
        <li class="covered" data-hits="404" data-linenumber="30">
          <span class="hits">404</span>
          
          <code class="ruby">      @variable_specs = vars</code>
        </li>
      
        <li class="covered" data-hits="404" data-linenumber="31">
          <span class="hits">404</span>
          
          <code class="ruby">      @variables = vars.map(&amp;:first)</code>
        </li>
      
        <li class="covered" data-hits="404" data-linenumber="32">
          <span class="hits">404</span>
          
          <code class="ruby">      @variables.uniq!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = ''.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = ','.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    PAIR_CONNECTOR = '='.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    PAIR_IF_EMPTY = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    LIST_CONNECTOR = ','.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    CHARACTER_CLASS = CHARACTER_CLASSES[:unreserved]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    NAMED = false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = ''</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    def level</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="48">
          <span class="hits">62</span>
          
          <code class="ruby">      if @variable_specs.none?{|_,expand,ml| expand || (ml &gt; 0) }</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="49">
          <span class="hits">18</span>
          
          <code class="ruby">        if @variable_specs.size == 1</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="50">
          <span class="hits">12</span>
          
          <code class="ruby">          return self.class::BASE_LEVEL</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="52">
          <span class="hits">6</span>
          
          <code class="ruby">          return 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="55">
          <span class="hits">9</span>
          
          <code class="ruby">        return 4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    def expands?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      @variable_specs.any?{|_,expand,_| expand }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    def arity</code>
        </li>
      
        <li class="covered" data-hits="420" data-linenumber="64">
          <span class="hits">420</span>
          
          <code class="ruby">      @variable_specs.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    def expand( vars )</code>
        </li>
      
        <li class="covered" data-hits="312" data-linenumber="68">
          <span class="hits">312</span>
          
          <code class="ruby">      result = []</code>
        </li>
      
        <li class="covered" data-hits="312" data-linenumber="69">
          <span class="hits">312</span>
          
          <code class="ruby">      @variable_specs.each{| var, expand , max_length |</code>
        </li>
      
        <li class="covered" data-hits="413" data-linenumber="70">
          <span class="hits">413</span>
          
          <code class="ruby">        unless vars[var].nil?</code>
        </li>
      
        <li class="covered" data-hits="402" data-linenumber="71">
          <span class="hits">402</span>
          
          <code class="ruby">          result.push(*expand_one(var, vars[var], expand, max_length))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="covered" data-hits="308" data-linenumber="74">
          <span class="hits">308</span>
          
          <code class="ruby">      if result.any?</code>
        </li>
      
        <li class="covered" data-hits="299" data-linenumber="75">
          <span class="hits">299</span>
          
          <code class="ruby">        return (self.class::PREFIX + result.join(self.class::SEPARATOR))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="77">
          <span class="hits">9</span>
          
          <code class="ruby">        return ''</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    def extract(position,matched)</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="82">
          <span class="hits">554</span>
          
          <code class="ruby">      name, expand, max_length = @variable_specs[position]</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="83">
          <span class="hits">554</span>
          
          <code class="ruby">      if matched.nil?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="84">
          <span class="hits">18</span>
          
          <code class="ruby">        return [[ name , extracted_nil ]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="536" data-linenumber="86">
          <span class="hits">536</span>
          
          <code class="ruby">      if expand</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="87">
          <span class="hits">161</span>
          
          <code class="ruby">        it = URITemplate::RegexpEnumerator.new(self.class.hash_extractor(max_length), :rest =&gt; :raise)</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="88">
          <span class="hits">161</span>
          
          <code class="ruby">        if position == 0</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="89">
          <span class="hits">159</span>
          
          <code class="ruby">          matched = &quot;#{self.class::SEPARATOR}#{matched}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="91">
          <span class="hits">161</span>
          
          <code class="ruby">        splitted = it.each(matched)\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">          .map do |match|</code>
        </li>
      
        <li class="covered" data-hits="413" data-linenumber="93">
          <span class="hits">413</span>
          
          <code class="ruby">            raise match.inspect if match.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="413" data-linenumber="94">
          <span class="hits">413</span>
          
          <code class="ruby">            [ decode(match[1]), decode(match[2], false) ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="96">
          <span class="hits">161</span>
          
          <code class="ruby">        return after_expand(name, splitted)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="375" data-linenumber="99">
          <span class="hits">375</span>
          
          <code class="ruby">      return [ [ name, decode( matched ) ] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_s</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="103">
          <span class="hits">20</span>
          
          <code class="ruby">      return '{' + self.class::OPERATOR + @variable_specs.map{|name,expand,max_length| name + (expand ? '*': '') + (max_length &gt; 0 ? (':' + max_length.to_s) : '') }.join(',') + '}'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    def expand_one( name, value, expand, max_length)</code>
        </li>
      
        <li class="covered" data-hits="402" data-linenumber="109">
          <span class="hits">402</span>
          
          <code class="ruby">      if length_limited?(max_length)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="110">
          <span class="hits">24</span>
          
          <code class="ruby">        if value.kind_of?(Array) or value.kind_of?(Hash)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="111">
          <span class="hits">4</span>
          
          <code class="ruby">          raise InvalidValue::LengthLimitInapplicable.new(name,value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="398" data-linenumber="114">
          <span class="hits">398</span>
          
          <code class="ruby">      if value.kind_of?(Hash) or Utils.pair_array?(value)</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="115">
          <span class="hits">71</span>
          
          <code class="ruby">        return transform_hash(name, value, expand, max_length)</code>
        </li>
      
        <li class="covered" data-hits="327" data-linenumber="116">
          <span class="hits">327</span>
          
          <code class="ruby">      elsif value.kind_of? Array</code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="117">
          <span class="hits">137</span>
          
          <code class="ruby">        return transform_array(name, value, expand, max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="190" data-linenumber="119">
          <span class="hits">190</span>
          
          <code class="ruby">        return self_pair(name, value, max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">    def length_limited?(max_length)</code>
        </li>
      
        <li class="covered" data-hits="402" data-linenumber="124">
          <span class="hits">402</span>
          
          <code class="ruby">      max_length &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">    def extracted_nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">  protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">    module ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      def hash_extractors</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="136">
          <span class="hits">169</span>
          
          <code class="ruby">        @hash_extractors ||= Hash.new{|hsh, key| hsh[key] = generate_hash_extractor(key) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">      def hash_extractor(max_length)</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="140">
          <span class="hits">161</span>
          
          <code class="ruby">        return hash_extractors[max_length]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">      def generate_hash_extractor(max_length)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="144">
          <span class="hits">8</span>
          
          <code class="ruby">        source = regex_builder</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="145">
          <span class="hits">8</span>
          
          <code class="ruby">        source.push('\\A')</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="146">
          <span class="hits">8</span>
          
          <code class="ruby">        source.escaped_separator</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="147">
          <span class="hits">8</span>
          
          <code class="ruby">        source.capture do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="148">
          <span class="hits">8</span>
          
          <code class="ruby">          source.character_class('+').reluctant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="150">
          <span class="hits">8</span>
          
          <code class="ruby">        source.group do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="151">
          <span class="hits">8</span>
          
          <code class="ruby">          source.escaped_pair_connector</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="152">
          <span class="hits">8</span>
          
          <code class="ruby">          source.capture do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="153">
          <span class="hits">8</span>
          
          <code class="ruby">            source.character_class(max_length,0).reluctant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">        end.length('?')</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="156">
          <span class="hits">8</span>
          
          <code class="ruby">        source.lookahead do</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="157">
          <span class="hits">8</span>
          
          <code class="ruby">          source.push '\\z'</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="158">
          <span class="hits">8</span>
          
          <code class="ruby">          source.push '|'</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="159">
          <span class="hits">8</span>
          
          <code class="ruby">          source.escaped_separator</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="160">
          <span class="hits">8</span>
          
          <code class="ruby">          source.push '[^'</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="161">
          <span class="hits">8</span>
          
          <code class="ruby">            source.escaped_separator</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="162">
          <span class="hits">8</span>
          
          <code class="ruby">          source.push ']'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="164">
          <span class="hits">8</span>
          
          <code class="ruby">        return Regexp.new( source.join , Utils::KCODE_UTF8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="167">
          <span class="hits">1</span>
          
          <code class="ruby">      def regex_builder</code>
        </li>
      
        <li class="covered" data-hits="225" data-linenumber="168">
          <span class="hits">225</span>
          
          <code class="ruby">        RegexBuilder.new(self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>
          
          <code class="ruby">    extend ClassMethods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">    def escape(x)</code>
        </li>
      
        <li class="covered" data-hits="855" data-linenumber="176">
          <span class="hits">855</span>
          
          <code class="ruby">      Utils.escape_url(Utils.object_to_param(x))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>
          
          <code class="ruby">    def unescape(x)</code>
        </li>
      
        <li class="covered" data-hits="1327" data-linenumber="180">
          <span class="hits">1327</span>
          
          <code class="ruby">      Utils.unescape_url(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">    def regex_builder</code>
        </li>
      
        <li class="covered" data-hits="217" data-linenumber="184">
          <span class="hits">217</span>
          
          <code class="ruby">      self.class.regex_builder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">    SPLITTER = /^(,+)|([^,]+)/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">    COMMA = &quot;,&quot;.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">    def decode(x, split = true)</code>
        </li>
      
        <li class="covered" data-hits="1201" data-linenumber="192">
          <span class="hits">1201</span>
          
          <code class="ruby">      if x.nil?</code>
        </li>
      
        <li class="covered" data-hits="114" data-linenumber="193">
          <span class="hits">114</span>
          
          <code class="ruby">        return extracted_nil</code>
        </li>
      
        <li class="covered" data-hits="1087" data-linenumber="194">
          <span class="hits">1087</span>
          
          <code class="ruby">      elsif split</code>
        </li>
      
        <li class="covered" data-hits="788" data-linenumber="195">
          <span class="hits">788</span>
          
          <code class="ruby">        result = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">        # Add a comma if the last character is a comma</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">        # seems weird but is more compatible than changing</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">        # the regex.</code>
        </li>
      
        <li class="covered" data-hits="788" data-linenumber="199">
          <span class="hits">788</span>
          
          <code class="ruby">        x += COMMA if x[-1..-1] == COMMA</code>
        </li>
      
        <li class="covered" data-hits="788" data-linenumber="200">
          <span class="hits">788</span>
          
          <code class="ruby">        URITemplate::RegexpEnumerator.new(SPLITTER, :rest =&gt; :raise).each(x) do |match|</code>
        </li>
      
        <li class="covered" data-hits="1932" data-linenumber="201">
          <span class="hits">1932</span>
          
          <code class="ruby">          if match[1]</code>
        </li>
      
        <li class="covered" data-hits="580" data-linenumber="202">
          <span class="hits">580</span>
          
          <code class="ruby">            next if match[1].size == 1</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="203">
          <span class="hits">24</span>
          
          <code class="ruby">            result &lt;&lt; match[1][0..-3]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">          elsif match[2]</code>
        </li>
      
        <li class="covered" data-hits="1352" data-linenumber="205">
          <span class="hits">1352</span>
          
          <code class="ruby">            result &lt;&lt; unescape(match[2])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="788" data-linenumber="208">
          <span class="hits">788</span>
          
          <code class="ruby">        case(result.size)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="209">
          <span class="hits">8</span>
          
          <code class="ruby">          when 0 then ''</code>
        </li>
      
        <li class="covered" data-hits="626" data-linenumber="210">
          <span class="hits">626</span>
          
          <code class="ruby">          when 1 then result.first</code>
        </li>
      
        <li class="covered" data-hits="154" data-linenumber="211">
          <span class="hits">154</span>
          
          <code class="ruby">          else result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="299" data-linenumber="214">
          <span class="hits">299</span>
          
          <code class="ruby">        unescape(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">    def cut(str,chars)</code>
        </li>
      
        <li class="covered" data-hits="558" data-linenumber="219">
          <span class="hits">558</span>
          
          <code class="ruby">      if chars &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="220">
          <span class="hits">20</span>
          
          <code class="ruby">        md = Regexp.compile(&quot;\\A#{self.class::CHARACTER_CLASS[:class]}{0,#{chars.to_s}}&quot;, Utils::KCODE_UTF8).match(str)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="221">
          <span class="hits">20</span>
          
          <code class="ruby">        return md[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="538" data-linenumber="223">
          <span class="hits">538</span>
          
          <code class="ruby">        return str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="227">
          <span class="hits">1</span>
          
          <code class="ruby">    def pair(key, value, max_length = 0, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="337" data-linenumber="228">
          <span class="hits">337</span>
          
          <code class="ruby">      ek = key</code>
        </li>
      
        <li class="covered" data-hits="337" data-linenumber="229">
          <span class="hits">337</span>
          
          <code class="ruby">      if block</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="230">
          <span class="hits">52</span>
          
          <code class="ruby">        ev = value.map(&amp;block).join(self.class::LIST_CONNECTOR) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="285" data-linenumber="232">
          <span class="hits">285</span>
          
          <code class="ruby">        ev = escape(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="337" data-linenumber="234">
          <span class="hits">337</span>
          
          <code class="ruby">      if !self.class::PAIR_IF_EMPTY and ev.size == 0</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="235">
          <span class="hits">2</span>
          
          <code class="ruby">        return ek</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="335" data-linenumber="237">
          <span class="hits">335</span>
          
          <code class="ruby">        return ek + self.class::PAIR_CONNECTOR + cut( ev, max_length )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="241">
          <span class="hits">1</span>
          
          <code class="ruby">    def transform_hash(name, hsh, expand , max_length)</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="242">
          <span class="hits">71</span>
          
          <code class="ruby">      if expand</code>
        </li>
      
        <li class="covered" data-hits="218" data-linenumber="243">
          <span class="hits">218</span>
          
          <code class="ruby">        hsh.map{|key,value| pair(escape(key),value) }</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="244">
          <span class="hits">11</span>
          
          <code class="ruby">      elsif hsh.none? &amp;&amp; !self.class::NAMED</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>
          
          <code class="ruby">        []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="247">
          <span class="hits">34</span>
          
          <code class="ruby">        [ self_pair(name,hsh){|key,value| escape(key)+self.class::LIST_CONNECTOR+escape(value)} ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="251">
          <span class="hits">1</span>
          
          <code class="ruby">    def transform_array(name, ary, expand , max_length)</code>
        </li>
      
        <li class="covered" data-hits="137" data-linenumber="252">
          <span class="hits">137</span>
          
          <code class="ruby">      if expand</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="253">
          <span class="hits">161</span>
          
          <code class="ruby">        ary.map{|value| self_pair(name,value) }</code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="254">
          <span class="hits">89</span>
          
          <code class="ruby">      elsif ary.none? &amp;&amp; !self.class::NAMED</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">        []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="501" data-linenumber="257">
          <span class="hits">501</span>
          
          <code class="ruby">        [ self_pair(name, ary){|value| escape(value) } ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  require 'uri_template/rfc6570/expression/named'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="263">
          <span class="hits">1</span>
          
          <code class="ruby">  require 'uri_template/rfc6570/expression/unnamed'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="265">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::Basic &lt; Expression::Unnamed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="268">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::Reserved &lt; Expression::Unnamed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">    CHARACTER_CLASS = CHARACTER_CLASSES[:unreserved_reserved_pct]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '+'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="272">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">    def escape(x)</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="275">
          <span class="hits">116</span>
          
          <code class="ruby">      Utils.escape_uri(Utils.object_to_param(x))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">    def unescape(x)</code>
        </li>
      
        <li class="covered" data-hits="168" data-linenumber="279">
          <span class="hits">168</span>
          
          <code class="ruby">      Utils.unescape_uri(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">    def scheme?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="283">
          <span class="hits">2</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="286">
          <span class="hits">1</span>
          
          <code class="ruby">    def host?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="287">
          <span class="hits">2</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="292">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::Fragment &lt; Expression::Unnamed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">    CHARACTER_CLASS = CHARACTER_CLASSES[:unreserved_reserved_pct]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="295">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = '#'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="296">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '#'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="297">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="299">
          <span class="hits">1</span>
          
          <code class="ruby">    def escape(x)</code>
        </li>
      
        <li class="covered" data-hits="108" data-linenumber="300">
          <span class="hits">108</span>
          
          <code class="ruby">      Utils.escape_uri(Utils.object_to_param(x))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="303">
          <span class="hits">1</span>
          
          <code class="ruby">    def unescape(x)</code>
        </li>
      
        <li class="covered" data-hits="156" data-linenumber="304">
          <span class="hits">156</span>
          
          <code class="ruby">      Utils.unescape_uri(x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="309">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::Label &lt; Expression::Unnamed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="311">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = '.'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="312">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = '.'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="313">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '.'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="314">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="318">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::Path &lt; Expression::Unnamed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="320">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = '/'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="321">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = '/'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="322">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '/'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="323">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="325">
          <span class="hits">1</span>
          
          <code class="ruby">    def starts_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="326">
          <span class="hits">4</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="331">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::PathParameters &lt; Expression::Named</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="333">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = ';'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="334">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = ';'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="335">
          <span class="hits">1</span>
          
          <code class="ruby">    NAMED = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">    PAIR_IF_EMPTY = false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="337">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = ';'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="338">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="342">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::FormQuery &lt; Expression::Named</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="344">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = '&amp;'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="345">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = '?'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="346">
          <span class="hits">1</span>
          
          <code class="ruby">    NAMED = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="347">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '?'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="348">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="352">
          <span class="hits">1</span>
          
          <code class="ruby">  class Expression::FormQueryContinuation &lt; Expression::Named</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="354">
          <span class="hits">1</span>
          
          <code class="ruby">    SEPARATOR = '&amp;'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="355">
          <span class="hits">1</span>
          
          <code class="ruby">    PREFIX = '&amp;'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">    NAMED = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">    OPERATOR = '&amp;'.freeze</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="358">
          <span class="hits">1</span>
          
          <code class="ruby">    BASE_LEVEL = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="363">
          <span class="hits">1</span>
          
          <code class="ruby">  OPERATORS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">    ''  =&gt; Expression::Basic,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">    '+' =&gt; Expression::Reserved,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">    '#' =&gt; Expression::Fragment,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">    '.' =&gt; Expression::Label,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">    '/' =&gt; Expression::Path,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">    ';' =&gt; Expression::PathParameters,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">    '?' =&gt; Expression::FormQuery,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">    '&amp;' =&gt; Expression::FormQueryContinuation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b97e0fe3146c9fb0fd6aeb28917b10cb0be28791">
  <div class="header">
    <h3>lib/uri_template/rfc6570/expression/named.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>31</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">class URITemplate::RFC6570::Expression::Named &lt; URITemplate::RFC6570::Expression</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  alias self_pair pair</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_r_source</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="25">
          <span class="hits">93</span>
          
          <code class="ruby">    source = regex_builder</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="26">
          <span class="hits">93</span>
          
          <code class="ruby">    source.group do</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="27">
          <span class="hits">93</span>
          
          <code class="ruby">      source.escaped_prefix</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="28">
          <span class="hits">93</span>
          
          <code class="ruby">      first = true</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="29">
          <span class="hits">93</span>
          
          <code class="ruby">      @variable_specs.each do | var, expand , max_length |</code>
        </li>
      
        <li class="covered" data-hits="145" data-linenumber="30">
          <span class="hits">145</span>
          
          <code class="ruby">        if expand</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="31">
          <span class="hits">32</span>
          
          <code class="ruby">          source.capture do</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="32">
          <span class="hits">32</span>
          
          <code class="ruby">            source.separated_list(first) do</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="33">
          <span class="hits">64</span>
          
          <code class="ruby">              source.character_class('+')\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">                .escaped_pair_connector\</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">                .character_class_with_comma(max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="39">
          <span class="hits">113</span>
          
          <code class="ruby">          source.group do</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="40">
          <span class="hits">113</span>
          
          <code class="ruby">            source.escaped_separator unless first</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="41">
          <span class="hits">113</span>
          
          <code class="ruby">            source &lt;&lt; Regexp.escape(var)</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="42">
          <span class="hits">113</span>
          
          <code class="ruby">            source.group do</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="43">
          <span class="hits">113</span>
          
          <code class="ruby">              source.escaped_pair_connector</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="44">
          <span class="hits">113</span>
          
          <code class="ruby">              source.capture do</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="45">
          <span class="hits">113</span>
          
          <code class="ruby">                source.character_class_with_comma(max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="covered" data-hits="113" data-linenumber="47">
          <span class="hits">113</span>
          
          <code class="ruby">              source &lt;&lt; '|' unless self.class::PAIR_IF_EMPTY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">          end.length('?')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="145" data-linenumber="51">
          <span class="hits">145</span>
          
          <code class="ruby">        first = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end.length('?')</code>
        </li>
      
        <li class="covered" data-hits="93" data-linenumber="54">
          <span class="hits">93</span>
          
          <code class="ruby">    return source.join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def extracted_nil</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="60">
          <span class="hits">14</span>
          
          <code class="ruby">    self.class::PAIR_IF_EMPTY ? nil : &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def after_expand(name, splitted)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="64">
          <span class="hits">55</span>
          
          <code class="ruby">    result = URITemplate::Utils.pair_array_to_hash2( splitted )</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="65">
          <span class="hits">55</span>
          
          <code class="ruby">    if result.size == 1 &amp;&amp; result[0][0] == name</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="66">
          <span class="hits">9</span>
          
          <code class="ruby">      return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="68">
          <span class="hits">46</span>
          
          <code class="ruby">      return [ [ name , result ] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d1a53ea0b314d5300e342176347ca474bcb4686d">
  <div class="header">
    <h3>lib/uri_template/rfc6570/expression/unnamed.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines. 
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">class URITemplate::RFC6570::Expression::Unnamed &lt; URITemplate::RFC6570::Expression</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self_pair(_, value, max_length = 0,&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="23">
          <span class="hits">223</span>
          
          <code class="ruby">    if block</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="24">
          <span class="hits">47</span>
          
          <code class="ruby">      ev = value.map(&amp;block).join(self.class::LIST_CONNECTOR) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="176" data-linenumber="26">
          <span class="hits">176</span>
          
          <code class="ruby">      ev = escape(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="28">
          <span class="hits">223</span>
          
          <code class="ruby">    cut( ev, max_length ,&amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_r_source</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="32">
          <span class="hits">124</span>
          
          <code class="ruby">    vs = @variable_specs.size - 1</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="33">
          <span class="hits">124</span>
          
          <code class="ruby">    i = 0</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="34">
          <span class="hits">124</span>
          
          <code class="ruby">    source = regex_builder</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="35">
          <span class="hits">124</span>
          
          <code class="ruby">    source.group do</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="36">
          <span class="hits">124</span>
          
          <code class="ruby">      source.escaped_prefix</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="37">
          <span class="hits">124</span>
          
          <code class="ruby">      @variable_specs.each do | var, expand , max_length |</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="38">
          <span class="hits">141</span>
          
          <code class="ruby">        last = (vs == i)</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="39">
          <span class="hits">141</span>
          
          <code class="ruby">        first = (i == 0)</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="40">
          <span class="hits">141</span>
          
          <code class="ruby">        if expand</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="41">
          <span class="hits">56</span>
          
          <code class="ruby">          source.group(true) do</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="42">
          <span class="hits">56</span>
          
          <code class="ruby">            source.separated_list(first) do</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="43">
          <span class="hits">110</span>
          
          <code class="ruby">              source.group do</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="44">
          <span class="hits">110</span>
          
          <code class="ruby">                source.character_class('+').reluctant</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="45">
          <span class="hits">110</span>
          
          <code class="ruby">                source.escaped_pair_connector</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">              end.length('?')</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="47">
          <span class="hits">110</span>
          
          <code class="ruby">              source.character_class(max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="51">
          <span class="hits">85</span>
          
          <code class="ruby">          source.escaped_separator unless first</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="52">
          <span class="hits">85</span>
          
          <code class="ruby">          source.group(true) do</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="53">
          <span class="hits">85</span>
          
          <code class="ruby">            if last</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="54">
          <span class="hits">71</span>
          
          <code class="ruby">              source.character_class_with_comma(max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">            else</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="56">
          <span class="hits">14</span>
          
          <code class="ruby">              source.character_class(max_length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="60">
          <span class="hits">141</span>
          
          <code class="ruby">        i = i+1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end.length('?')</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="63">
          <span class="hits">124</span>
          
          <code class="ruby">    return source.join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def after_expand(name, splitted)</code>
        </li>
      
        <li class="covered" data-hits="268" data-linenumber="69">
          <span class="hits">268</span>
          
          <code class="ruby">    if splitted.none?{|_,b| b }</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="70">
          <span class="hits">172</span>
          
          <code class="ruby">      return [ [ name, splitted.map{|a,_| a } ] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="72">
          <span class="hits">48</span>
          
          <code class="ruby">      return [ [ name, splitted ] ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e8e766627c1416175838d0d9b6e8a4e6eb2ac836">
  <div class="header">
    <h3>lib/uri_template/rfc6570/regex_builder.rb</h3>
    <h4><span class="green">92.98 %</span> covered</h4>
    <div>
      <b>57</b> relevant lines. 
      <span class="green"><b>53</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require 'uri_template/rfc6570'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">class URITemplate::RFC6570</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  class RegexBuilder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(expression_class)</code>
        </li>
      
        <li class="covered" data-hits="225" data-linenumber="25">
          <span class="hits">225</span>
          
          <code class="ruby">      @expression_class = expression_class</code>
        </li>
      
        <li class="covered" data-hits="225" data-linenumber="26">
          <span class="hits">225</span>
          
          <code class="ruby">      @source = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    def &lt;&lt;(arg)</code>
        </li>
      
        <li class="covered" data-hits="4906" data-linenumber="30">
          <span class="hits">4906</span>
          
          <code class="ruby">      @source &lt;&lt; arg</code>
        </li>
      
        <li class="covered" data-hits="4906" data-linenumber="31">
          <span class="hits">4906</span>
          
          <code class="ruby">      self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    def push(*args)</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="35">
          <span class="hits">216</span>
          
          <code class="ruby">      @source.push(*args)</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="36">
          <span class="hits">216</span>
          
          <code class="ruby">      self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    def escaped_pair_connector</code>
        </li>
      
        <li class="covered" data-hits="295" data-linenumber="40">
          <span class="hits">295</span>
          
          <code class="ruby">      self &lt;&lt; Regexp.escape(@expression_class::PAIR_CONNECTOR)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    def escaped_separator</code>
        </li>
      
        <li class="covered" data-hits="179" data-linenumber="44">
          <span class="hits">179</span>
          
          <code class="ruby">      self &lt;&lt; Regexp.escape(@expression_class::SEPARATOR)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    def escaped_prefix</code>
        </li>
      
        <li class="covered" data-hits="217" data-linenumber="48">
          <span class="hits">217</span>
          
          <code class="ruby">      self &lt;&lt; Regexp.escape(@expression_class::PREFIX)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    def join</code>
        </li>
      
        <li class="covered" data-hits="225" data-linenumber="52">
          <span class="hits">225</span>
          
          <code class="ruby">      return @source.join</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    def length(*args)</code>
        </li>
      
        <li class="covered" data-hits="536" data-linenumber="56">
          <span class="hits">536</span>
          
          <code class="ruby">      self &lt;&lt; format_length(*args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    def character_class_with_comma(max_length=0, min = 0)</code>
        </li>
      
        <li class="covered" data-hits="248" data-linenumber="60">
          <span class="hits">248</span>
          
          <code class="ruby">      self &lt;&lt; @expression_class::CHARACTER_CLASS[:class_with_comma] &lt;&lt; format_length(max_length, min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    def character_class(max_length=0, min = 0)</code>
        </li>
      
        <li class="covered" data-hits="314" data-linenumber="64">
          <span class="hits">314</span>
          
          <code class="ruby">      self &lt;&lt; @expression_class::CHARACTER_CLASS[:class] &lt;&lt; format_length(max_length, min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    def reluctant</code>
        </li>
      
        <li class="covered" data-hits="126" data-linenumber="68">
          <span class="hits">126</span>
          
          <code class="ruby">      self &lt;&lt; '?'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    def group(capture = false)</code>
        </li>
      
        <li class="covered" data-hits="863" data-linenumber="72">
          <span class="hits">863</span>
          
          <code class="ruby">      self &lt;&lt; '('</code>
        </li>
      
        <li class="covered" data-hits="863" data-linenumber="73">
          <span class="hits">863</span>
          
          <code class="ruby">      self &lt;&lt; '?:' unless capture</code>
        </li>
      
        <li class="covered" data-hits="863" data-linenumber="74">
          <span class="hits">863</span>
          
          <code class="ruby">      yield</code>
        </li>
      
        <li class="covered" data-hits="863" data-linenumber="75">
          <span class="hits">863</span>
          
          <code class="ruby">      self &lt;&lt; ')'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    def negative_lookahead</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      self &lt;&lt; '(?!'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      yield</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      self &lt;&lt; ')'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">    def lookahead</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="85">
          <span class="hits">8</span>
          
          <code class="ruby">      self &lt;&lt; '(?='</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="86">
          <span class="hits">8</span>
          
          <code class="ruby">      yield</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="87">
          <span class="hits">8</span>
          
          <code class="ruby">      self &lt;&lt; ')'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    def capture(&amp;block)</code>
        </li>
      
        <li class="covered" data-hits="161" data-linenumber="91">
          <span class="hits">161</span>
          
          <code class="ruby">      group(true, &amp;block)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">    def separated_list(first = true, length = 0, min = 1, &amp;block)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="95">
          <span class="hits">88</span>
          
          <code class="ruby">      if first</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="96">
          <span class="hits">86</span>
          
          <code class="ruby">        yield</code>
        </li>
      
        <li class="covered" data-hits="86" data-linenumber="97">
          <span class="hits">86</span>
          
          <code class="ruby">        min -= 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="99">
          <span class="hits">88</span>
          
          <code class="ruby">      self.push('(?:').escaped_separator</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="100">
          <span class="hits">88</span>
          
          <code class="ruby">      yield</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="101">
          <span class="hits">88</span>
          
          <code class="ruby">      self.push(')').length(length, min)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    def format_length(len, min = 0)</code>
        </li>
      
        <li class="covered" data-hits="1098" data-linenumber="107">
          <span class="hits">1098</span>
          
          <code class="ruby">      return len if len.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="468" data-linenumber="108">
          <span class="hits">468</span>
          
          <code class="ruby">      return '{'+min.to_s+','+len.to_s+'}' if len.kind_of?(Numeric) and len &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="458" data-linenumber="109">
          <span class="hits">458</span>
          
          <code class="ruby">      return '*' if min == 0</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="110">
          <span class="hits">2</span>
          
          <code class="ruby">      return '+' if min == 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">      return '{'+min.to_s+',}'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2cacadfea260c7a295cc371f99994f16154ec4df">
  <div class="header">
    <h3>lib/uri_template/token.rb</h3>
    <h4><span class="yellow">88.89 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># This should make it possible to do basic analysis independently from the concrete type.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"># Usually the submodules {URITemplate::Literal} and {URITemplate::Expression} are used.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"># @abstract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate::Token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  EMPTY_ARRAY = [].freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # The variable names used in this token.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  # @return [Array&lt;String&gt;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def variables</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="30">
          <span class="hits">11</span>
          
          <code class="ruby">    EMPTY_ARRAY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  # Number of variables in this token</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    variables.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def starts_with_slash?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def ends_with_slash?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="43">
          <span class="hits">4</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def scheme?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="47">
          <span class="hits">12</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def host?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="51">
          <span class="hits">12</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  # @abstract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def expand(variables)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    raise &quot;Please implement #expand(variables) on #{self.class.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  # @abstract</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    raise &quot;Please implement #to_s on #{self.class.inspect}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f8d256d1ef3e0fd588dc69c54499afd0f2cfe206">
  <div class="header">
    <h3>lib/uri_template/utils.rb</h3>
    <h4><span class="yellow">88.8 %</span> covered</h4>
    <div>
      <b>125</b> relevant lines. 
      <span class="green"><b>111</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># -*- encoding : utf-8 -*-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby">#    This program is free software: you can redistribute it and/or modify</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#    it under the terms of the Affero GNU General Public License as published by</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">#    the Free Software Foundation, either version 3 of the License, or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#    (at your option) any later version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#    This program is distributed in the hope that it will be useful,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    GNU General Public License for more details.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#    You should have received a copy of the GNU General Public License</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#    (c) 2011 - 2012 by Hannes Georg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">module URITemplate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  # An awesome little helper which helps iterating over a string.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # Initialize with a regexp and pass a string to :each.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  # It will yield a string or a MatchData</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  class RegexpEnumerator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    include Enumerable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(regexp, options = {})</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="28">
          <span class="hits">985</span>
          
          <code class="ruby">      @regexp = regexp</code>
        </li>
      
        <li class="covered" data-hits="1021" data-linenumber="29">
          <span class="hits">1021</span>
          
          <code class="ruby">      @rest = options.fetch(:rest){ :yield }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    def each(str)</code>
        </li>
      
        <li class="covered" data-hits="1182" data-linenumber="33">
          <span class="hits">1182</span>
          
          <code class="ruby">      raise ArgumentError, &quot;RegexpEnumerator#each expects a String, but got #{str.inspect}&quot; unless str.kind_of? String</code>
        </li>
      
        <li class="covered" data-hits="1182" data-linenumber="34">
          <span class="hits">1182</span>
          
          <code class="ruby">      return Enumerator.new(self,:each,str) unless block_given?</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="35">
          <span class="hits">985</span>
          
          <code class="ruby">      rest = str</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="36">
          <span class="hits">985</span>
          
          <code class="ruby">      loop do</code>
        </li>
      
        <li class="covered" data-hits="3356" data-linenumber="37">
          <span class="hits">3356</span>
          
          <code class="ruby">        m = @regexp.match(rest)</code>
        </li>
      
        <li class="covered" data-hits="3356" data-linenumber="38">
          <span class="hits">3356</span>
          
          <code class="ruby">        if m.nil?</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="39">
          <span class="hits">985</span>
          
          <code class="ruby">          if rest.size &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="40">
          <span class="hits">18</span>
          
          <code class="ruby">            yield rest if @rest == :yield</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="41">
          <span class="hits">18</span>
          
          <code class="ruby">            raise &quot;Unable to match #{rest.inspect} against #{@regexp.inspect}&quot; if @rest == :raise</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="43">
          <span class="hits">985</span>
          
          <code class="ruby">          break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="2371" data-linenumber="45">
          <span class="hits">2371</span>
          
          <code class="ruby">        yield m.pre_match if m.pre_match.size &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="2371" data-linenumber="46">
          <span class="hits">2371</span>
          
          <code class="ruby">        yield m</code>
        </li>
      
        <li class="covered" data-hits="2371" data-linenumber="47">
          <span class="hits">2371</span>
          
          <code class="ruby">        if m[0].size == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">          # obviously matches empty string, so post_match will equal rest</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">          # terminate or this will loop forever</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">          if m.post_match.size &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">            yield m.post_match if @rest == :yield</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">            raise &quot;#{@regexp.inspect} matched an empty string. The rest is #{m.post_match.inspect}.&quot; if @rest == :raise</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">          break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="2371" data-linenumber="56">
          <span class="hits">2371</span>
          
          <code class="ruby">        rest = m.post_match</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="985" data-linenumber="58">
          <span class="hits">985</span>
          
          <code class="ruby">      return self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  # This error will be raised whenever an object could not be converted to a param string.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  class Unconvertable &lt; StandardError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    attr_reader :object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize(object)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">      @object = object</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">      super(&quot;Could not convert the given object (#{Object.instance_method(:inspect).bind(@object).call() rescue '&lt;????&gt;'}) to a param since it doesn't respond to :to_param or :to_s.&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # A collection of some utility methods.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  # The most methods are used to parse or generate uri-parameters.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  # I will use the escape_utils library if available, but runs happily without.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  module Utils</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    KCODE_UTF8 = (Regexp::KCODE_UTF8 rescue 0)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    # Bundles some string encoding methods.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">    module StringEncoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      # @method to_ascii(string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      # converts a string to ascii</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">      # @param str [String]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      # @return String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      # @visibility public</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_ascii_encode(str)</code>
        </li>
      
        <li class="covered" data-hits="1702" data-linenumber="93">
          <span class="hits">1702</span>
          
          <code class="ruby">        str.encode(Encoding::ASCII)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      # @method to_utf8(string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      # converts a string to utf8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      # @param str [String]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      # @return String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      # @visibility public</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_utf8_encode(str)</code>
        </li>
      
        <li class="covered" data-hits="1160" data-linenumber="103">
          <span class="hits">1160</span>
          
          <code class="ruby">        str.encode(Encoding::UTF_8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      # @method force_utf8(str)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      # enforces UTF8 encoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      # </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      # @param str [String]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">      # @return String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      # @visibility public</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">      def force_utf8_encode(str)</code>
        </li>
      
        <li class="covered" data-hits="1702" data-linenumber="113">
          <span class="hits">1702</span>
          
          <code class="ruby">        return str if str.encoding == Encoding::UTF_8</code>
        </li>
      
        <li class="covered" data-hits="1702" data-linenumber="114">
          <span class="hits">1702</span>
          
          <code class="ruby">        str = str.dup if str.frozen?</code>
        </li>
      
        <li class="covered" data-hits="1702" data-linenumber="115">
          <span class="hits">1702</span>
          
          <code class="ruby">        return str.force_encoding(Encoding::UTF_8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_ascii_fallback(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">        str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">      def to_utf8_fallback(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">        str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">      def force_utf8_fallback(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">        str</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">      if &quot;&quot;.respond_to?(:encode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">        send(:alias_method, :to_ascii, :to_ascii_encode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">        send(:alias_method, :to_utf8, :to_utf8_encode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">        send(:alias_method, :force_utf8, :force_utf8_encode)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">        send(:alias_method, :to_ascii, :to_ascii_fallback)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">        send(:alias_method, :to_utf8, :to_utf8_fallback)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">        # @api private</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">        send(:alias_method, :force_utf8, :force_utf8_fallback)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">      public :to_ascii</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">      public :to_utf8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">    module Escaping</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">      # A pure escaping module, which implements escaping methods in pure ruby.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">      # The performance is acceptable, but could be better with escape_utils.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">      module Pure</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">        include StringEncoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">        # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="161">
          <span class="hits">1</span>
          
          <code class="ruby">        URL_ESCAPED = /([^A-Za-z0-9\-\._])/.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">        # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>
          
          <code class="ruby">        URI_ESCAPED = /([^A-Za-z0-9!$&amp;'()*+,.\/:;=?@\[\]_~])/.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">        # @private</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="167">
          <span class="hits">1</span>
          
          <code class="ruby">        PCT = /%([0-9a-fA-F]{2})/.freeze</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">        def escape_url(s)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="170">
          <span class="hits">8</span>
          
          <code class="ruby">          to_utf8(s.to_s).gsub(URL_ESCAPED){</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="171">
          <span class="hits">11</span>
          
          <code class="ruby">            '%'+$1.unpack('H2'*$1.bytesize).join('%').upcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">        def escape_uri(s)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="176">
          <span class="hits">8</span>
          
          <code class="ruby">          to_utf8(s.to_s).gsub(URI_ESCAPED){</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="177">
          <span class="hits">10</span>
          
          <code class="ruby">            '%'+$1.unpack('H2'*$1.bytesize).join('%').upcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>
          
          <code class="ruby">        def unescape_url(s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">          force_utf8( to_ascii(s).gsub('+',' ').gsub(PCT){</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="183">
          <span class="hits">5</span>
          
          <code class="ruby">            $1.to_i(16).chr</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="184">
          <span class="hits">11</span>
          
          <code class="ruby">          } )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">        def unescape_uri(s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">          force_utf8( to_ascii(s).gsub(PCT){</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="189">
          <span class="hits">5</span>
          
          <code class="ruby">            $1.to_i(16).chr</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="190">
          <span class="hits">11</span>
          
          <code class="ruby">          })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>
          
          <code class="ruby">        def using_escape_utils?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">          false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">    if defined? EscapeUtils</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      # A escaping module, which is backed by escape_utils.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">      # The performance is good, espacially for strings with many escaped characters.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">      module EscapeUtils</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">        include StringEncoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="207">
          <span class="hits">1</span>
          
          <code class="ruby">        include ::EscapeUtils</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">        def using_escape_utils?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="210">
          <span class="hits">3</span>
          
          <code class="ruby">          true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">        def escape_url(s)</code>
        </li>
      
        <li class="covered" data-hits="866" data-linenumber="214">
          <span class="hits">866</span>
          
          <code class="ruby">          super(to_utf8(s)).gsub('+','%20')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">        def escape_uri(s)</code>
        </li>
      
        <li class="covered" data-hits="278" data-linenumber="218">
          <span class="hits">278</span>
          
          <code class="ruby">          super(to_utf8(s))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">        def unescape_url(s)</code>
        </li>
      
        <li class="covered" data-hits="1345" data-linenumber="222">
          <span class="hits">1345</span>
          
          <code class="ruby">          force_utf8(super(to_ascii(s)))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">        def unescape_uri(s)</code>
        </li>
      
        <li class="covered" data-hits="335" data-linenumber="226">
          <span class="hits">335</span>
          
          <code class="ruby">          force_utf8(super(to_ascii(s)))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>
          
          <code class="ruby">    include StringEncoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="237">
          <span class="hits">1</span>
          
          <code class="ruby">    if Escaping.const_defined? :EscapeUtils</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">      include Escaping::EscapeUtils</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">      puts &quot;Using escape_utils.&quot; if $VERBOSE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">      include Escaping::Pure</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">      puts &quot;Not using escape_utils.&quot; if $VERBOSE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">    # Converts an object to a param value.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">    # Tries to call :to_param and then :to_s on that object.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">    # @raise Unconvertable if the object could not be converted.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">    #   URITemplate::Utils.object_to_param(5) #=&gt; &quot;5&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">    #   o = Object.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    #   def o.to_param</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">    #     &quot;42&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">    #   URITemplate::Utils.object_to_param(o) #=&gt; &quot;42&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="255">
          <span class="hits">1</span>
          
          <code class="ruby">    def object_to_param(object)</code>
        </li>
      
        <li class="covered" data-hits="1090" data-linenumber="256">
          <span class="hits">1090</span>
          
          <code class="ruby">      if object.respond_to? :to_param</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="257">
          <span class="hits">1</span>
          
          <code class="ruby">        object.to_param</code>
        </li>
      
        <li class="covered" data-hits="1088" data-linenumber="258">
          <span class="hits">1088</span>
          
          <code class="ruby">      elsif object.respond_to? :to_s</code>
        </li>
      
        <li class="covered" data-hits="1087" data-linenumber="259">
          <span class="hits">1087</span>
          
          <code class="ruby">        object.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="261">
          <span class="hits">1</span>
          
          <code class="ruby">        raise Unconvertable.new(object) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">    rescue NoMethodError</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">      raise Unconvertable.new(object)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">    # @api private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">    # Should we use \u.... or \x.. in regexps?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="269">
          <span class="hits">1</span>
          
          <code class="ruby">    def use_unicode?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">      return eval('Regexp.compile(&quot;\u0020&quot;)') =~ &quot; &quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">    rescue SyntaxError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">      false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">    # Returns true when the given value is an array and it only consists of arrays with two items.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">    # This useful when using a hash is not ideal, since it doesn't allow duplicate keys.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array?( Object.new ) #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array?( [] ) #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array?( [1,2,3] ) #=&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array?( [ ['a',1],['b',2],['c',3] ] ) #=&gt; true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array?( [ ['a',1],['b',2],['c',3],[] ] ) #=&gt; false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="283">
          <span class="hits">1</span>
          
          <code class="ruby">    def pair_array?(a)</code>
        </li>
      
        <li class="covered" data-hits="337" data-linenumber="284">
          <span class="hits">337</span>
          
          <code class="ruby">      return false unless a.kind_of? Array</code>
        </li>
      
        <li class="covered" data-hits="293" data-linenumber="285">
          <span class="hits">293</span>
          
          <code class="ruby">      return a.all?{|p| p.kind_of? Array and p.size == 2 }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">    # Turns the given value into a hash if it is an array of pairs.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">    # Otherwise it returns the value.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">    # You can test whether a value will be converted with {#pair_array?}.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">    # @example</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array_to_hash( 'x' ) #=&gt; 'x'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array_to_hash( [ ['a',1],['b',2],['c',3] ] ) #=&gt; {'a'=&gt;1,'b'=&gt;2,'c'=&gt;3}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array_to_hash( [ ['a',1],['a',2],['a',3] ] ) #=&gt; {'a'=&gt;3}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">    # @example Carful vs. Ignorant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array_to_hash( [ ['a',1],'foo','bar'], false ) #UNDEFINED!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">    #   URITemplate::Utils.pair_array_to_hash( [ ['a',1],'foo','bar'], true )  #=&gt; [ ['a',1], 'foo', 'bar']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">    # @param x the value to convert</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">    # @param careful [true,false] wheter to check every array item. Use this when you expect array with subarrays which are not pairs. Setting this to false however improves runtime by ~30% even with comparetivly short arrays.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="303">
          <span class="hits">1</span>
          
          <code class="ruby">    def pair_array_to_hash(x, careful = false )</code>
        </li>
      
        <li class="covered" data-hits="554" data-linenumber="304">
          <span class="hits">554</span>
          
          <code class="ruby">      if careful ? pair_array?(x) : (x.kind_of?(Array) and ( x.empty? or x.first.kind_of?(Array) ) )</code>
        </li>
      
        <li class="covered" data-hits="95" data-linenumber="305">
          <span class="hits">95</span>
          
          <code class="ruby">        return Hash[ x ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="459" data-linenumber="307">
          <span class="hits">459</span>
          
          <code class="ruby">        return x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="311">
          <span class="hits">1</span>
          
          <code class="ruby">    extend self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">    # @api privat</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="314">
          <span class="hits">1</span>
          
          <code class="ruby">    def pair_array_to_hash2(x)</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="315">
          <span class="hits">55</span>
          
          <code class="ruby">      c = {}</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="316">
          <span class="hits">55</span>
          
          <code class="ruby">      result = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="318">
          <span class="hits">55</span>
          
          <code class="ruby">      x.each do | (k,v) |</code>
        </li>
      
        <li class="covered" data-hits="155" data-linenumber="319">
          <span class="hits">155</span>
          
          <code class="ruby">        e = c[k]</code>
        </li>
      
        <li class="covered" data-hits="155" data-linenumber="320">
          <span class="hits">155</span>
          
          <code class="ruby">        if !e</code>
        </li>
      
        <li class="covered" data-hits="133" data-linenumber="321">
          <span class="hits">133</span>
          
          <code class="ruby">          result &lt;&lt; c[k] = [k,v]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="323">
          <span class="hits">22</span>
          
          <code class="ruby">          e[1] = [e[1]] unless e[1].kind_of? Array</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="324">
          <span class="hits">22</span>
          
          <code class="ruby">          e[1] &lt;&lt; v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="328">
          <span class="hits">55</span>
          
          <code class="ruby">      return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
